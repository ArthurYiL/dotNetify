{"version":3,"sources":["webpack://dotnetify/webpack/universalModuleDefinition","webpack://dotnetify/webpack/bootstrap","webpack://dotnetify/(webpack)/buildin/global.js","webpack://dotnetify/./src/dotnetify/react/dotnetify-react.js","webpack://dotnetify/./src/dotnetify/libs/jquery-shim.js","webpack://dotnetify/./src/dotnetify/libs/utils.js","webpack://dotnetify/external {\"commonjs\":\"react\",\"commonjs2\":\"react\",\"amd\":\"react\",\"root\":\"React\"}","webpack://dotnetify/./src/dotnetify/core/dotnetify-vm.js","webpack://dotnetify/./src/dotnetify/core/dotnetify-hub-local.js","webpack://dotnetify/external {\"commonjs\":\"@aspnet/signalr\",\"commonjs2\":\"@aspnet/signalr\",\"amd\":\"@aspnet/signalr\",\"root\":\"signalR\"}","webpack://dotnetify/./node_modules/jquery-deferred/lib/jquery-core.js","webpack://dotnetify/./node_modules/jquery-deferred/lib/jquery-callbacks.js","webpack://dotnetify/./node_modules/jquery-deferred/lib/jquery-deferred.js","webpack://dotnetify/./node_modules/jquery-deferred/index.js","webpack://dotnetify/(webpack)/buildin/module.js","webpack://dotnetify/./src/dotnetify/core/dotnetify-hub.js","webpack://dotnetify/./src/dotnetify/core/dotnetify.js","webpack://dotnetify/./src/dotnetify/react/RouteTarget.js","webpack://dotnetify/./src/dotnetify/react/RouteLink.js","webpack://dotnetify/./node_modules/prop-types/lib/ReactPropTypesSecret.js","webpack://dotnetify/./node_modules/prop-types/factoryWithThrowingShims.js","webpack://dotnetify/./node_modules/prop-types/index.js","webpack://dotnetify/./src/dotnetify/react/Scope.js","webpack://dotnetify/./src/dotnetify/react/ssr.js","webpack://dotnetify/./src/dotnetify/core/dotnetify-vm-router.js","webpack://dotnetify/external {\"commonjs\":\"react-dom\",\"commonjs2\":\"react-dom\",\"amd\":\"react-dom\",\"root\":\"ReactDOM\"}","webpack://dotnetify/./src/dotnetify/react/dotnetify-react.vm-router.js","webpack://dotnetify/./src/dotnetify/libs/path.js","webpack://dotnetify/./src/dotnetify/core/dotnetify-router.js","webpack://dotnetify/./src/dotnetify/react/dotnetify-react.router.js","webpack://dotnetify/./src/dotnetify/react/index.js"],"names":["window","global","dotnetify","_dotnetify","react","version","viewModels","plugins","controller","_hubs","init","iHub","self","hubInitialized","some","hub","start","isHubStarted","Object","keys","filter","vmId","$hub","forEach","$requested","startHub","responseEvent","subscribe","iVMId","iVMData","_responseVM","connectedEvent","$request","reconnectedEvent","mode","push","connect","iReact","iOptions","arguments","length","Error","vmArg","ssr","ssrConnect","hasOwnProperty","console","error","$destroy","setTimeout","component","props","state","setState","connectInfo","selectHub","options","dotnetifyVM","getViewModels","map","vm","checkServerSideException","$exceptionHandler","$update","addVMAccessor","jQueryDeferred","require","jQueryShim","extend","selector","document","on","iEvent","iHandler","addEventListener","bind","unbind","removeEventListener","events","event","handlers","idx","indexOf","splice","triggerHandler","iArgs","args","type","Array","isArray","arg","handler","apply","load","iUrl","request","XMLHttpRequest","open","onload","status","response","responseText","querySelector","innerHTML","call","send","abort","reason","support","cors","trim","iStr","inArray","iArray","iItem","makeArray","slice","merge","iArray1","iArray2","prototype","isEmptyObject","iObj","ajax","onreadystatechange","readyState","_hasError","success","JSON","parse","url","setRequestHeader","contentType","data","getScript","iSuccess","done","promise","Deferred","head","getElementsByTagName","script","createElement","src","removeChild","resolve","appendChild","jQuery","exports","module","utils","substr","iStr1","iStr2","toLowerCase","iValue","Event","dispatchEvent","createEvent","initEvent","iFilter","createEventEmitter","subscribers","emit","handled","subscriber","includes","x","iComponent","iDotNetify","$vmId","$component","$options","$vmArg","$headers","$loaded","$itemKey","$dotnetify","getState","State","Props","prop","$","$getPlugins","plugin","$inject","isConnected","disposeVM","ex","handleConnectionStateChanged","updateVM","debug","log","debugFn","key","listName","item","$dispatch","$updateList","id","iVMUpdate","match","exec","$addList","$removeList","i","itemKey","$setItemKey","requestVM","vmData","$preProcess","$onLoad","$onUpdate","$ready","iItemKey","assign","iListName","iNewItem","items","normalize","replace","hasLocalVM","onConnect","dotNetifyHubLocal","connectionFailedEvent","iVMArgs","$pushUpdate","update","stringify","onDispatch","onDestroy","signalRNetCore","dotnetifyHubFactory","dotnetifyHub","reconnectDelay","reconnectRetry","_startInfo","_init","server","request_VM","update_VM","dispose_VM","hubOptions","doneHandler","failHandler","forceRestart","_doneHandler","_failHandler","failHander","fail","err","iHubPath","iServerUrl","signalR","HubConnection","defineProperty","get","_connection","connection","connectionState","hubPath","_reconnectCount","_startDoneHandler","_startFailHandler","_disconnectedHandler","_stateChangedHandler","iNewState","_onDisconnected","_changeState","stateText","_startConnection","iHubOptions","iTransportArray","transport","shift","HubConnectionBuilder","withUrl","build","client","response_VM","onclose","then","catch","transportOptions","webSockets","serverSentEvents","longPolling","disconnected","stateChanged","reconnect","iStartHubFunc","delay","invoke","undefined","makeProxyCallback","callback","registerHubProxies","instance","shouldSubscribe","memberKey","memberValue","subscriptionMethod","hubName","off","isFunction","hubConnection","createHubProxies","proxies","starting","_registerSubscribedHubs","createHubProxy","useDefaultPath","set","val","dotNetifyHub","connected","deferred","source","message","warn","newState","create","dotnetifyFactory","offline","isOffline","offlineTimeout","offlineCacheFn","_vmAccessors","connectionStateHandler","connectHandler","hubServerUrl","createHub","hubLib","initHub","vmConnectArgs","override","localHub","vmAccessor","iExceptionHandler","exception","name","ExceptionType","Message","reduce","prev","current","iState","iException","RouteTarget","elem","getElementById","initialHtml","__html","el","React","Component","router","RouteLink","handleClick","preventDefault","route","onClick","$handleRoute","style","className","$route","children","Scope","scope","context","scoped","_this","dispatch","dispatchState","vmStates","displayName","propTypes","PropTypes","string","contextTypes","func","childContextTypes","isRequired","iVMArg","vmState","ssrState","fetched","iPath","iInitialStates","iOverrideRouteFn","iCallbackFn","iTimeout","urlPath","overrideUrl","text","insertBefore","firstChild","routed","fallback","clearTimeout","dotnetifyVMRouter","routes","RoutingState","Active","iArg","path","currentTarget","pathname","pushState","hasRoutingState","Root","_absRoot","absRoot","VMRoot","root","templates","Templates","$init","initRoot","urlPattern","template","UrlPattern","Id","mapUrl","toUrl","mapTo","param","iParams","routeTo","activeUrl","routeUrl","raiseRoutedEvent","iRoute","equal","Path","iTargetSelector","iViewUrl","iJsModuleUrl","unmountView","getScripts","split","when","callbackFn","iHtmlElement","iVmArg","mountViewFunc","target","iTarget","iJSModuleUrl","Target","ViewUrl","JSModuleUrl","iTemplate","force","TemplateId","RedirectRoot","redirectRoot","charAt","redirectRootPath","urlRedirect","absRootPath","Url","$template","pathToRoute","iDisableEvent","isRedirect","vmOther","$router","VMArg","onRouteEnter","redirect","loadView","dispatchActiveRoutingState","onRouteExit","redirectUrlPath","grep","startsWith","routeElem","dotnetifyReactVMRouter","iVM","iDotNetifyRouter","reactProps","vmRoot","endsWith","loadHtmlView","HTMLElement","loadHtmlElementView","loadReactView","iReactProps","Promise","reject","reactElement","ReactDOM","render","e","unmountComponentAtNode","defined","core","rescue","fn","history","initial","title","supported","location","hash","popState","initialPop","popped","href","URL","listen","onpopstate","parameterize","params","possible_routes","j","compare","result","partition","search","join","passed_route","previous_route","matched_route","previous","do_exit","run","documentMode","onhashchange","setInterval","action","do_enter","to","enter","fns","concat","exit","parts","re","halt_execution","dotnetifyRouter","iFn","iUrlPath","matched","iTitle","initRouting","handleRoute","$routeTo","routeToRoute","$mount","iProps"],"mappings":"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BAAM,OAAKvB,aAAL,CAAmByI,IAAnB,CAAwBvI,KAAxB,EAA+BwB,KAA/B,CAAN;AAAA,WAAX;AACD;AACF;AACF;;;8BAESxB,K,EAAO;AACf,UAAMP,OAAOsM,UAAU/L,KAAV,CAAb;AACA,UAAMgC,KAAK5D,OAAOqB,IAAP,CAAX;;AAEA,UAAI,QAAOuC,EAAP,yCAAOA,EAAP,OAAc,QAAd,IAA0B,OAAOA,GAAG0K,SAAV,IAAuB,UAArD,EAAiE;AAC/D1K,WAAG0K,SAAH,CAAa1M,KAAb;AACD;AACF;;;;;;kBAGY,IAAImM,iBAAJ,E;QACNF,U,GAAAA,U;;;;;;;ACpFT,gD;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,CAAC;;;AAGD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,UAAU,YAAY;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,UAAU,YAAY;AACtB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,QAAQ,YAAY;AACpB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,MAAM;AACN;AACA;;AAEA;AACA;;AAEA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;ACxJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB;;AAEnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,oCAAoC;AAC9C;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,OAAO;AACP,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;AC3MA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA,MAAM;AACN,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,8CAA8C;AAC9C,KAAK;AACL;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,IAAI;;AAEJ;;AAEA,4CAA4C;AAC5C;AACA;AACA;AACA;AACA,UAAU,YAAY;AACtB;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;;;;;;;;ACjKD,yC;;;;;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;;;;;;;;;;;;;;qjBCrBA;;;;;;;;;;;;;;;;;AAeA;;AACA;;;;;;;;AACA,IAAMU,iBAAiB,mBAAArK,CAAQ,CAAR,CAAvB;AACA,IAAIoH,IAAInH,oBAAR;;AAEA,IAAMnE,SAASA,UAAUC,MAAV,IAAoB,EAAnC;;IAEauO,mB,WAAAA,mB;;;;;;;6BACK;AACd,UAAIC,eAAe;AACjBpO,iBAAS,OADQ;AAEjBkF,cAAM,IAFW;;AAIjBmJ,wBAAgB,CAAE,CAAF,EAAK,CAAL,EAAQ,EAAR,CAJC;AAKjBC,wBAAgB,IALC;;AAOjBC,oBAAY,IAPK;AAQjBC,eAAO,KARU;;AAUjB;AACA7B,mBAAW,mBA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","file":"dotnetify-react.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"react\"), require(\"@aspnet/signalr\"), require(\"react-dom\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"react\", \"@aspnet/signalr\", \"react-dom\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"dotnetify\"] = factory(require(\"react\"), require(\"@aspnet/signalr\"), require(\"react-dom\"));\n\telse\n\t\troot[\"dotnetify\"] = factory(root[\"React\"], root[\"signalR\"], root[\"ReactDOM\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__4__, __WEBPACK_EXTERNAL_MODULE__7__, __WEBPACK_EXTERNAL_MODULE__23__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 28);\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || Function(\"return this\")() || (1, eval)(\"this\");\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","/* \r\nCopyright 2017-2018 Dicky Suryadi\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n */\r\nimport _dotnetify from '../core/dotnetify';\r\nimport dotnetifyVM from '../core/dotnetify-vm';\r\n\r\nconst window = window || global || {};\r\nlet dotnetify = window.dotnetify || _dotnetify;\r\n\r\ndotnetify.react = {\r\n  version: '3.0.0',\r\n  viewModels: {},\r\n  plugins: {},\r\n  controller: dotnetify,\r\n\r\n  // Internal variables.\r\n  _hubs: [],\r\n\r\n  // Initializes connection to SignalR server hub.\r\n  init: function(iHub) {\r\n    const self = dotnetify.react;\r\n    const hubInitialized = self._hubs.some(hub => hub === iHub);\r\n\r\n    const start = function() {\r\n      if (!iHub.isHubStarted)\r\n        Object.keys(self.viewModels)\r\n          .filter(vmId => self.viewModels[vmId].$hub === iHub)\r\n          .forEach(vmId => (self.viewModels[vmId].$requested = false));\r\n\r\n      dotnetify.startHub(iHub);\r\n    };\r\n\r\n    if (!hubInitialized) {\r\n      iHub.responseEvent.subscribe((iVMId, iVMData) => self._responseVM(iVMId, iVMData));\r\n      iHub.connectedEvent.subscribe(() =>\r\n        Object.keys(self.viewModels)\r\n          .filter(vmId => self.viewModels[vmId].$hub === iHub && !self.viewModels[vmId].$requested)\r\n          .forEach(vmId => self.viewModels[vmId].$request())\r\n      );\r\n      iHub.reconnectedEvent.subscribe(start);\r\n\r\n      if (iHub.mode !== 'local') self._hubs.push(iHub);\r\n    }\r\n\r\n    start();\r\n  },\r\n\r\n  // Connects to a server view model.\r\n  connect: function(iVMId, iReact, iOptions) {\r\n    if (arguments.length < 2) throw new Error('[dotNetify] Missing arguments. Usage: connect(vmId, component) ');\r\n\r\n    const vmArg = iOptions && iOptions['vmArg'];\r\n\r\n    if (dotnetify.ssr && dotnetify.react.ssrConnect) {\r\n      return dotnetify.react.ssrConnect(iVMId, iReact, vmArg);\r\n    }\r\n\r\n    const self = dotnetify.react;\r\n    if (self.viewModels.hasOwnProperty(iVMId)) {\r\n      console.error(\r\n        `Component is attempting to connect to an already active '${iVMId}'. ` +\r\n          ` If it's from a dismounted component, you must add vm.$destroy to componentWillUnmount().`\r\n      );\r\n      self.viewModels[iVMId].$destroy();\r\n      return setTimeout(() => self.connect(iVMId, iReact, iOptions));\r\n    }\r\n\r\n    const component = {\r\n      get props() {\r\n        return iReact.props;\r\n      },\r\n      get state() {\r\n        return iReact.state;\r\n      },\r\n      setState(state) {\r\n        iReact.setState(state);\r\n      }\r\n    };\r\n\r\n    const connectInfo = dotnetify.selectHub({ vmId: iVMId, options: iOptions, hub: null });\r\n    self.viewModels[iVMId] = new dotnetifyVM(connectInfo.vmId, component, connectInfo.options, self, connectInfo.hub);\r\n    if (connectInfo.hub) self.init(connectInfo.hub);\r\n\r\n    return self.viewModels[iVMId];\r\n  },\r\n\r\n  // Get all view models.\r\n  getViewModels: function() {\r\n    const self = dotnetify.react;\r\n    return Object.keys(self.viewModels).map(vmId => self.viewModels[vmId]);\r\n  },\r\n\r\n  _responseVM: function(iVMId, iVMData) {\r\n    const self = dotnetify.react;\r\n\r\n    if (self.viewModels.hasOwnProperty(iVMId)) {\r\n      const vm = self.viewModels[iVMId];\r\n      dotnetify.checkServerSideException(iVMId, iVMData, vm.$exceptionHandler);\r\n      vm.$update(iVMData);\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n};\r\n\r\ndotnetify.addVMAccessor(dotnetify.react.getViewModels);\r\n\r\nexport default dotnetify;\r\n","/* \r\nCopyright 2017 Dicky Suryadi\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n */\r\n\r\nconst window = window || global || {};\r\n\r\nconst jQueryDeferred = require('jquery-deferred');\r\nconst jQueryShim = jQueryDeferred.extend(\r\n  function(selector) {\r\n    if (selector === window || selector.document)\r\n      return {\r\n        0: selector,\r\n        on: function(iEvent, iHandler) {\r\n          window.addEventListener(iEvent, iHandler);\r\n        },\r\n        bind: function(iEvent, iHandler) {\r\n          window.addEventListener(iEvent, iHandler, false);\r\n        },\r\n        unbind: function(iEvent, iHandler) {\r\n          window.removeEventListener(iEvent, iHandler, false);\r\n        }\r\n      };\r\n\r\n    if (typeof selector !== 'string') selector.events = selector.events || {};\r\n\r\n    return {\r\n      0: selector,\r\n\r\n      bind: function(iEvent, iHandler) {\r\n        var event = selector.events[iEvent] || [];\r\n        event.push(iHandler);\r\n        selector.events[iEvent] = event;\r\n      },\r\n\r\n      unbind: function(iEvent, iHandler) {\r\n        var handlers = selector.events[iEvent] || [];\r\n        if (iHandler) {\r\n          var idx = handlers.indexOf(iHandler);\r\n          if (idx !== -1) handlers.splice(idx, 1);\r\n        }\r\n        else handlers = [];\r\n        selector.events[iEvent] = handlers;\r\n      },\r\n\r\n      triggerHandler: function(iEvent, iArgs) {\r\n        var handlers = selector.events[iEvent] || [];\r\n        var args = [ { type: iEvent } ];\r\n        if (Array.isArray(iArgs))\r\n          iArgs.forEach(function(arg) {\r\n            args.push(arg);\r\n          });\r\n        else if (iArgs) args.push(iArgs);\r\n        handlers.forEach(function(handler) {\r\n          handler.apply(this, args);\r\n        });\r\n      },\r\n\r\n      load: function(iUrl, iArgs, iHandler) {\r\n        var request = new window.XMLHttpRequest();\r\n        request.open('GET', iUrl, true);\r\n        request.onload = function() {\r\n          if (request.status >= 200 && request.status < 400) {\r\n            var response = request.responseText;\r\n            document.querySelector(selector).innerHTML = response;\r\n            iHandler.call(document.querySelector(selector));\r\n          }\r\n        };\r\n        request.send();\r\n        return {\r\n          abort: function(reason) {\r\n            return request.abort(reason);\r\n          }\r\n        };\r\n      }\r\n    };\r\n  },\r\n  jQueryDeferred,\r\n  {\r\n    support: { cors: true },\r\n\r\n    trim: function(iStr) {\r\n      return typeof iStr === 'string' ? iStr.trim() : iStr;\r\n    },\r\n\r\n    inArray: function(iArray, iItem) {\r\n      return iArray.indexOf(iItem) !== -1;\r\n    },\r\n\r\n    makeArray: function makeArray(iArray) {\r\n      return [].slice.call(iArray, 0);\r\n    },\r\n\r\n    merge: function(iArray1, iArray2) {\r\n      Array.prototype.push.apply(iArray1, iArray2);\r\n      return iArray1;\r\n    },\r\n\r\n    isEmptyObject: function(iObj) {\r\n      return !iObj || Object.keys(iObj).length === 0;\r\n    },\r\n\r\n    ajax: function(iOptions) {\r\n      var request = new window.XMLHttpRequest();\r\n      request.onreadystatechange = function() {\r\n        if (request.readyState !== 4) return;\r\n        if (request.status === 200 && !request._hasError) {\r\n          try {\r\n            iOptions.success && iOptions.success(JSON.parse(request.responseText));\r\n          } catch (error) {\r\n            iOptions.success && iOptions.success(request.responseText);\r\n          }\r\n        }\r\n        else iOptions.error && iOptions.error(request);\r\n      };\r\n      request.open(iOptions.type, iOptions.url);\r\n      request.setRequestHeader('content-type', iOptions.contentType);\r\n      request.send(iOptions.data.data && 'data=' + iOptions.data.data);\r\n      return {\r\n        abort: function(reason) {\r\n          return request.abort(reason);\r\n        }\r\n      };\r\n    },\r\n\r\n    getScript: function(iUrl, iSuccess) {\r\n      var done = false;\r\n      var promise = jQueryDeferred.Deferred();\r\n      var head = document.getElementsByTagName('head')[0];\r\n      var script = document.createElement('script');\r\n      script.src = iUrl;\r\n      script.onload = script.onreadystatechange = function() {\r\n        if (!done && (!this.readyState || this.readyState == 'loaded' || this.readyState == 'complete')) {\r\n          done = true;\r\n          script.onload = script.onreadystatechange = null;\r\n          head.removeChild(script);\r\n          if (typeof iSuccess === 'function') iSuccess();\r\n          promise.resolve();\r\n        }\r\n      };\r\n      head.appendChild(script);\r\n      return promise;\r\n    }\r\n  }\r\n);\r\n\r\nif (typeof window !== 'undefined') window.jQuery = window.jQuery || jQueryShim;\r\n\r\nif (typeof exports === 'object' && typeof module === 'object') module.exports = jQueryShim;\r\n","/* \r\nCopyright 2018 Dicky Suryadi\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n */\r\nconst window = window || global || {};\r\n\r\nclass utils {\r\n  // Trim slashes from start and end of string.\r\n  trim(iStr) {\r\n    if (typeof iStr !== 'string') return '';\r\n\r\n    while (iStr.indexOf('/', iStr.length - 1) >= 0) iStr = iStr.substr(0, iStr.length - 1);\r\n    while (iStr.indexOf('/') == 0) iStr = iStr.substr(1, iStr.length - 1);\r\n    return iStr;\r\n  }\r\n\r\n  // Match two strings case-insensitive.\r\n  equal(iStr1, iStr2) {\r\n    return iStr1 != null && iStr2 != null && iStr1.toLowerCase() == iStr2.toLowerCase();\r\n  }\r\n\r\n  // Whether the string starts or ends with a value.\r\n  startsWith(iStr, iValue) {\r\n    return iStr.toLowerCase().slice(0, iValue.length) == iValue.toLowerCase();\r\n  }\r\n\r\n  endsWith(iStr, iValue) {\r\n    return iValue == '' || iStr.toLowerCase().slice(-iValue.length) == iValue.toLowerCase();\r\n  }\r\n\r\n  // Dispatch event with IE polyfill.\r\n  dispatchEvent(iEvent) {\r\n    if (typeof Event === 'function') window.dispatchEvent(new Event(iEvent));\r\n    else {\r\n      var event = document.createEvent('CustomEvent');\r\n      event.initEvent(iEvent, true, true);\r\n      window.dispatchEvent(event);\r\n    }\r\n  }\r\n\r\n  grep(iArray, iFilter) {\r\n    return Array.isArray(iArray) ? iArray.filter(iFilter) : [];\r\n  }\r\n}\r\n\r\nexport const createEventEmitter = _ => {\r\n  let subscribers = [];\r\n  return {\r\n    emit(...args) {\r\n      let handled = false;\r\n      subscribers.forEach(subscriber => {\r\n        handled = subscriber(...args) || handled;\r\n      });\r\n      return handled;\r\n    },\r\n\r\n    subscribe(subscriber) {\r\n      !subscribers.includes(subscriber) && subscribers.push(subscriber);\r\n      return () => (subscribers = subscribers.filter(x => x !== subscriber));\r\n    }\r\n  };\r\n};\r\n\r\nexport default new utils();\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE__4__;","/* \r\nCopyright 2017-2018 Dicky Suryadi\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n */\r\nimport $ from '../libs/jquery-shim';\r\n\r\nconst window = window || global || {};\r\n\r\n// Client-side view model that acts as a proxy of the server view model.\r\nexport default class dotnetifyVM {\r\n  // iVMId - identifies the view model.\r\n  // iComponent - component object.\r\n  // iOptions - Optional configuration options:\r\n  //    getState: state accessor.\r\n  //    setState: state mutator.\r\n  //    vmArg: view model arguments.\r\n  //    headers: request headers, for things like authentication token.\r\n  //    exceptionHandler: called when receiving server-side exception.\r\n  // iDotNetify - framework-specific dotNetify library.\r\n  // iHub - hub connection.\r\n  constructor(iVMId, iComponent, iOptions, iDotNetify, iHub) {\r\n    this.$vmId = iVMId;\r\n    this.$component = iComponent;\r\n    this.$options = iOptions || {};\r\n    this.$vmArg = iOptions && iOptions['vmArg'];\r\n    this.$headers = iOptions && iOptions['headers'];\r\n    this.$exceptionHandler = iOptions && iOptions['exceptionHandler'];\r\n    this.$requested = false;\r\n    this.$loaded = false;\r\n    this.$itemKey = {};\r\n    this.$dotnetify = iDotNetify;\r\n    this.$hub = iHub;\r\n\r\n    let getState = iOptions && iOptions['getState'];\r\n    let setState = iOptions && iOptions['setState'];\r\n    getState = typeof getState === 'function' ? getState : () => iComponent.state;\r\n    setState = typeof setState === 'function' ? setState : state => iComponent.setState(state);\r\n\r\n    this.State = state => (typeof state === 'undefined' ? getState() : setState(state));\r\n    this.Props = prop => this.$component.props && this.$component.props[prop];\r\n\r\n    const vmArg = this.Props('vmArg');\r\n    if (vmArg) this.$vmArg = $.extend(this.$vmArg, vmArg);\r\n\r\n    // Inject plugin functions into this view model.\r\n    this.$getPlugins().map(plugin => (typeof plugin['$inject'] == 'function' ? plugin.$inject(this) : null));\r\n  }\r\n\r\n  // Disposes the view model, both here and on the server.\r\n  $destroy() {\r\n    // Call any plugin's $destroy function if provided.\r\n    this.$getPlugins().map(plugin => (typeof plugin['$destroy'] == 'function' ? plugin.$destroy.apply(this) : null));\r\n\r\n    if (this.$hub.isConnected) {\r\n      try {\r\n        this.$hub.disposeVM(this.$vmId);\r\n      } catch (ex) {\r\n        this.$dotnetify.controller.handleConnectionStateChanged('error', ex, this.$hub);\r\n      }\r\n    }\r\n\r\n    delete this.$dotnetify.viewModels[this.$vmId];\r\n  }\r\n\r\n  // Dispatches a value to the server view model.\r\n  // iValue - Value to dispatch.\r\n  $dispatch(iValue) {\r\n    if (this.$hub.isConnected) {\r\n      const controller = this.$dotnetify.controller;\r\n      try {\r\n        this.$hub.updateVM(this.$vmId, iValue);\r\n\r\n        if (controller.debug) {\r\n          console.log('[' + this.$vmId + '] sent> ');\r\n          console.log(iValue);\r\n\r\n          controller.debugFn && controller.debugFn(this.$vmId, 'sent', iValue);\r\n        }\r\n      } catch (ex) {\r\n        controller.handleConnectionStateChanged('error', ex, this.$hub);\r\n      }\r\n    }\r\n  }\r\n\r\n  // Dispatches a state value to the server view model.\r\n  // iValue - State value to dispatch.\r\n  $dispatchListState(iValue) {\r\n    for (var listName in iValue) {\r\n      const key = this.$itemKey[listName];\r\n      if (!key) {\r\n        console.error(`[${this.$vmId}] missing item key for '${listName}'; add ${listName}_itemKey property to the view model.`);\r\n        return;\r\n      }\r\n      var item = iValue[listName];\r\n      if (!item[key]) {\r\n        console.error(`[${this.$vmId}] couldn't dispatch data from '${listName}' due to missing property '${key}'.`);\r\n        console.error(item);\r\n        return;\r\n      }\r\n\r\n      Object.keys(item).forEach(prop => {\r\n        if (prop != key) {\r\n          let state = {};\r\n          state[listName + '.$' + item[key] + '.' + prop] = item[prop];\r\n          this.$dispatch(state);\r\n        }\r\n      });\r\n      this.$updateList(listName, item);\r\n    }\r\n  }\r\n\r\n  $getPlugins() {\r\n    return Object.keys(this.$dotnetify.plugins).map(id => this.$dotnetify.plugins[id]);\r\n  }\r\n\r\n  // Preprocess view model update from the server before we set the state.\r\n  $preProcess(iVMUpdate) {\r\n    const vm = this;\r\n\r\n    for (var prop in iVMUpdate) {\r\n      // Look for property that end with '_add'. Interpret the value as a list item to be added\r\n      // to an existing list whose property name precedes that suffix.\r\n      var match = /(.*)_add/.exec(prop);\r\n      if (match != null) {\r\n        var listName = match[1];\r\n        if (Array.isArray(this.State()[listName])) vm.$addList(listName, iVMUpdate[prop]);\r\n        else console.error('unable to resolve ' + prop);\r\n        delete iVMUpdate[prop];\r\n        continue;\r\n      }\r\n\r\n      // Look for property that end with '_update'. Interpret the value as a list item to be updated\r\n      // to an existing list whose property name precedes that suffix.\r\n      var match = /(.*)_update/.exec(prop);\r\n      if (match != null) {\r\n        var listName = match[1];\r\n        if (Array.isArray(this.State()[listName])) vm.$updateList(listName, iVMUpdate[prop]);\r\n        else console.error('[' + this.$vmId + \"] '\" + listName + \"' is not found or not an array.\");\r\n        delete iVMUpdate[prop];\r\n        continue;\r\n      }\r\n\r\n      // Look for property that end with '_remove'. Interpret the value as a list item key to remove\r\n      // from an existing list whose property name precedes that suffix.\r\n      var match = /(.*)_remove/.exec(prop);\r\n      if (match != null) {\r\n        var listName = match[1];\r\n        if (Array.isArray(this.State()[listName])) {\r\n          var key = this.$itemKey[listName];\r\n          if (key != null)\r\n            vm.$removeList(listName, function(i) {\r\n              return i[key] == iVMUpdate[prop];\r\n            });\r\n          else console.error(`[${this.$vmId}] missing item key for '${listName}'; add ${listName}_itemKey property to the view model.`);\r\n        }\r\n        else console.error(`[${this.$vmId}] '${listName}' is not found or not an array.`);\r\n        delete iVMUpdate[prop];\r\n        continue;\r\n      }\r\n\r\n      // Look for property that end with '_itemKey'. Interpret the value as the property name that will\r\n      // uniquely identify items in the list.\r\n      var match = /(.*)_itemKey/.exec(prop);\r\n      if (match != null) {\r\n        var listName = match[1];\r\n        var itemKey = {};\r\n        itemKey[listName] = iVMUpdate[prop];\r\n        vm.$setItemKey(itemKey);\r\n        delete iVMUpdate[prop];\r\n        continue;\r\n      }\r\n    }\r\n  }\r\n\r\n  // Requests state from the server view model.\r\n  $request() {\r\n    if (this.$hub.isConnected) this.$hub.requestVM(this.$vmId, { $vmArg: this.$vmArg, $headers: this.$headers });\r\n    this.$requested = true;\r\n  }\r\n\r\n  // Updates state from the server view model to the view.\r\n  // iVMData - Serialized state from the server.\r\n  $update(iVMData) {\r\n    const controller = this.$dotnetify.controller;\r\n    if (controller.debug) {\r\n      console.log('[' + this.$vmId + '] received> ');\r\n      console.log(JSON.parse(iVMData));\r\n\r\n      controller.debugFn && controller.debugFn(this.$vmId, 'received', JSON.parse(iVMData));\r\n    }\r\n    let vmData = JSON.parse(iVMData);\r\n    this.$preProcess(vmData);\r\n\r\n    let state = this.State();\r\n    state = $.extend({}, state, vmData);\r\n    this.State(state);\r\n\r\n    if (!this.$loaded) this.$onLoad();\r\n    else this.$onUpdate(vmData);\r\n  }\r\n\r\n  // Handles initial view model load event.\r\n  $onLoad() {\r\n    this.$getPlugins().map(plugin => (typeof plugin['$ready'] == 'function' ? plugin.$ready.apply(this) : null));\r\n    this.$loaded = true;\r\n  }\r\n\r\n  // Handles view model update event.\r\n  $onUpdate(vmData) {\r\n    this.$getPlugins().map(plugin => (typeof plugin['$update'] == 'function' ? plugin.$update.apply(this, [ vmData ]) : null));\r\n  }\r\n\r\n  // *** CRUD Functions ***\r\n\r\n  // Sets items key to identify individual items in a list.\r\n  // Accepts object literal: { \"<list name>\": \"<key prop name>\", ... }\r\n  $setItemKey(iItemKey) {\r\n    Object.assign(this.$itemKey, iItemKey);\r\n  }\r\n\r\n  //// Adds a new item to a state array.\r\n  $addList(iListName, iNewItem) {\r\n    // Check if the list already has an item with the same key. If so, replace it.\r\n    var key = this.$itemKey[iListName];\r\n    if (key != null) {\r\n      if (!iNewItem.hasOwnProperty(key)) {\r\n        console.error(`[${this.$vmId}] couldn't add item to '${iListName}' due to missing property '${key}'.`);\r\n        return;\r\n      }\r\n      var match = this.State()[iListName].filter(function(i) {\r\n        return i[key] == iNewItem[key];\r\n      });\r\n      if (match.length > 0) {\r\n        console.error(`[${this.$vmId}] couldn't add item to '${iListName}' because the key already exists.`);\r\n        return;\r\n      }\r\n    }\r\n\r\n    let items = this.State()[iListName];\r\n    items.push(iNewItem);\r\n\r\n    let state = {};\r\n    state[iListName] = items;\r\n    this.State(state);\r\n  }\r\n\r\n  // Removes an item from a state array.\r\n  $removeList(iListName, iFilter) {\r\n    let state = {};\r\n    state[iListName] = this.State()[iListName].filter(i => !iFilter(i));\r\n    this.State(state);\r\n  }\r\n\r\n  //// Updates existing item to an observable array.\r\n  $updateList(iListName, iNewItem) {\r\n    // Check if the list already has an item with the same key. If so, update it.\r\n    let key = this.$itemKey[iListName];\r\n    if (key != null) {\r\n      if (!iNewItem.hasOwnProperty(key)) {\r\n        console.error(`[${this.$vmId}] couldn't update item to '${iListName}' due to missing property '${key}'.`);\r\n        return;\r\n      }\r\n      var state = {};\r\n      state[iListName] = this.State()[iListName].map(function(i) {\r\n        return i[key] == iNewItem[key] ? $.extend(i, iNewItem) : i;\r\n      });\r\n      this.State(state);\r\n    }\r\n    else console.error(`[${this.$vmId}] missing item key for '${iListName}'; add '${iListName}_itemKey' property to the view model.`);\r\n  }\r\n}\r\n","/* \r\nimport { dotnetify } from 'dotnetify/dist/dotnetify-ko';\r\nCopyright 2019 Dicky Suryadi\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n */\r\nimport { createEventEmitter } from '../libs/utils';\r\n\r\nconst window = window || global || {};\r\n\r\nconst normalize = iVMId => iVMId && iVMId.replace(/\\./g, '_');\r\nconst hasLocalVM = iVMId => {\r\n  const vmId = normalize(iVMId);\r\n  const vm = window[vmId];\r\n  return typeof vm == 'object' && typeof vm.onConnect == 'function';\r\n};\r\n\r\nexport class dotNetifyHubLocal {\r\n  mode = 'local';\r\n  debug = false;\r\n  isConnected = false;\r\n  isHubStarted = false;\r\n\r\n  responseEvent = createEventEmitter();\r\n  reconnectedEvent = createEventEmitter();\r\n  connectedEvent = createEventEmitter();\r\n  connectionFailedEvent = createEventEmitter();\r\n\r\n  startHub() {\r\n    this.isConnected = true;\r\n    this.isHubStarted = true;\r\n    this.connectedEvent.emit();\r\n  }\r\n\r\n  requestVM(iVMId, iVMArgs) {\r\n    const vmId = normalize(iVMId);\r\n    const vm = window[vmId];\r\n\r\n    if (typeof vm === 'object' && typeof vm.onConnect == 'function') {\r\n      if (this.debug) console.log(`[${iVMId}] *** local mode ***`);\r\n\r\n      vm.$pushUpdate = update => {\r\n        if (typeof update == 'object') update = JSON.stringify(update);\r\n        setTimeout(() => this.responseEvent.emit(iVMId, update));\r\n      };\r\n\r\n      vm.$pushUpdate(vm.onConnect(iVMArgs) || {});\r\n    }\r\n  }\r\n\r\n  updateVM(iVMId, iValue) {\r\n    const vmId = normalize(iVMId);\r\n    const vm = window[vmId];\r\n\r\n    if (typeof vm === 'object' && typeof vm.onDispatch == 'function') {\r\n      let state = vm.onDispatch(iValue);\r\n      if (state) {\r\n        if (typeof state == 'object') state = JSON.stringify(state);\r\n        setTimeout(() => this.responseEvent.emit(iVMId, state));\r\n      }\r\n    }\r\n  }\r\n\r\n  disposeVM(iVMId) {\r\n    const vmId = normalize(iVMId);\r\n    const vm = window[vmId];\r\n\r\n    if (typeof vm === 'object' && typeof vm.onDestroy == 'function') {\r\n      vm.onDestroy(iVMId);\r\n    }\r\n  }\r\n}\r\n\r\nexport default new dotNetifyHubLocal();\r\nexport { hasLocalVM };\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE__7__;","/**\n* jQuery core object.\n*\n* Worker with jQuery deferred\n*\n* Code from: https://github.com/jquery/jquery/blob/master/src/core.js\n*\n*/\n\nvar jQuery = module.exports = {\n\ttype: type\n\t, isArray: isArray\n\t, isFunction: isFunction\n\t, isPlainObject: isPlainObject\n\t, each: each\n\t, extend: extend\n\t, noop: function() {}\n};\n\nvar toString = Object.prototype.toString;\n\nvar class2type = {};\n// Populate the class2type map\n\"Boolean Number String Function Array Date RegExp Object\".split(\" \").forEach(function(name) {\n\tclass2type[ \"[object \" + name + \"]\" ] = name.toLowerCase();\n});\n\n\nfunction type( obj ) {\n\treturn obj == null ?\n\t\tString( obj ) :\n\t\t\tclass2type[ toString.call(obj) ] || \"object\";\n}\n\nfunction isFunction( obj ) {\n\treturn jQuery.type(obj) === \"function\";\n}\n\nfunction isArray( obj ) {\n\treturn jQuery.type(obj) === \"array\";\n}\n\nfunction each( object, callback, args ) {\n\tvar name, i = 0,\n\tlength = object.length,\n\tisObj = length === undefined || isFunction( object );\n\n\tif ( args ) {\n\t\tif ( isObj ) {\n\t\t\tfor ( name in object ) {\n\t\t\t\tif ( callback.apply( object[ name ], args ) === false ) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tfor ( ; i < length; ) {\n\t\t\t\tif ( callback.apply( object[ i++ ], args ) === false ) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// A special, fast, case for the most common use of each\n\t} else {\n\t\tif ( isObj ) {\n\t\t\tfor ( name in object ) {\n\t\t\t\tif ( callback.call( object[ name ], name, object[ name ] ) === false ) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tfor ( ; i < length; ) {\n\t\t\t\tif ( callback.call( object[ i ], i, object[ i++ ] ) === false ) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn object;\n}\n\nfunction isPlainObject( obj ) {\n\t// Must be an Object.\n\tif ( !obj || jQuery.type(obj) !== \"object\" ) {\n\t\treturn false;\n\t}\n\treturn true;\n}\n\nfunction extend() {\n\tvar options, name, src, copy, copyIsArray, clone,\n\ttarget = arguments[0] || {},\n\ti = 1,\n\tlength = arguments.length,\n\tdeep = false;\n\n\t// Handle a deep copy situation\n\tif ( typeof target === \"boolean\" ) {\n\t\tdeep = target;\n\t\ttarget = arguments[1] || {};\n\t\t// skip the boolean and the target\n\t\ti = 2;\n\t}\n\n\t// Handle case when target is a string or something (possible in deep copy)\n\tif ( typeof target !== \"object\" && !jQuery.isFunction(target) ) {\n\t\ttarget = {};\n\t}\n\n\t// extend jQuery itself if only one argument is passed\n\tif ( length === i ) {\n\t\ttarget = this;\n\t\t--i;\n\t}\n\n\tfor ( ; i < length; i++ ) {\n\t\t// Only deal with non-null/undefined values\n\t\tif ( (options = arguments[ i ]) != null ) {\n\t\t\t// Extend the base object\n\t\t\tfor ( name in options ) {\n\t\t\t\tsrc = target[ name ];\n\t\t\t\tcopy = options[ name ];\n\n\t\t\t\t// Prevent never-ending loop\n\t\t\t\tif ( target === copy ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Recurse if we're merging plain objects or arrays\n\t\t\t\tif ( deep && copy && ( jQuery.isPlainObject(copy) || (copyIsArray = jQuery.isArray(copy)) ) ) {\n\t\t\t\t\tif ( copyIsArray ) {\n\t\t\t\t\t\tcopyIsArray = false;\n\t\t\t\t\t\tclone = src && jQuery.isArray(src) ? src : [];\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tclone = src && jQuery.isPlainObject(src) ? src : {};\n\t\t\t\t\t}\n\n\t\t\t\t\t// Never move original objects, clone them\n\t\t\t\t\ttarget[ name ] = jQuery.extend( deep, clone, copy );\n\n\t\t\t\t\t// Don't bring in undefined values\n\t\t\t\t} else if ( copy !== undefined ) {\n\t\t\t\t\ttarget[ name ] = copy;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Return the modified object\n\treturn target;\n};\n\n\n","var jQuery = module.exports = require(\"./jquery-core.js\"),\n\tcore_rspace = /\\s+/;\n/**\n* jQuery Callbacks\n*\n* Code from: https://github.com/jquery/jquery/blob/master/src/callbacks.js\n*\n*/\n\n\n// String to Object options format cache\nvar optionsCache = {};\n\n// Convert String-formatted options into Object-formatted ones and store in cache\nfunction createOptions( options ) {\n\tvar object = optionsCache[ options ] = {};\n\tjQuery.each( options.split( core_rspace ), function( _, flag ) {\n\t\tobject[ flag ] = true;\n\t});\n\treturn object;\n}\n\n/*\n * Create a callback list using the following parameters:\n *\n *\toptions: an optional list of space-separated options that will change how\n *\t\t\tthe callback list behaves or a more traditional option object\n *\n * By default a callback list will act like an event callback list and can be\n * \"fired\" multiple times.\n *\n * Possible options:\n *\n *\tonce:\t\t\twill ensure the callback list can only be fired once (like a Deferred)\n *\n *\tmemory:\t\t\twill keep track of previous values and will call any callback added\n *\t\t\t\t\tafter the list has been fired right away with the latest \"memorized\"\n *\t\t\t\t\tvalues (like a Deferred)\n *\n *\tunique:\t\t\twill ensure a callback can only be added once (no duplicate in the list)\n *\n *\tstopOnFalse:\tinterrupt callings when a callback returns false\n *\n */\njQuery.Callbacks = function( options ) {\n\n\t// Convert options from String-formatted to Object-formatted if needed\n\t// (we check in cache first)\n\toptions = typeof options === \"string\" ?\n\t\t( optionsCache[ options ] || createOptions( options ) ) :\n\t\tjQuery.extend( {}, options );\n\n\tvar // Last fire value (for non-forgettable lists)\n\t\tmemory,\n\t\t// Flag to know if list was already fired\n\t\tfired,\n\t\t// Flag to know if list is currently firing\n\t\tfiring,\n\t\t// First callback to fire (used internally by add and fireWith)\n\t\tfiringStart,\n\t\t// End of the loop when firing\n\t\tfiringLength,\n\t\t// Index of currently firing callback (modified by remove if needed)\n\t\tfiringIndex,\n\t\t// Actual callback list\n\t\tlist = [],\n\t\t// Stack of fire calls for repeatable lists\n\t\tstack = !options.once && [],\n\t\t// Fire callbacks\n\t\tfire = function( data ) {\n\t\t\tmemory = options.memory && data;\n\t\t\tfired = true;\n\t\t\tfiringIndex = firingStart || 0;\n\t\t\tfiringStart = 0;\n\t\t\tfiringLength = list.length;\n\t\t\tfiring = true;\n\t\t\tfor ( ; list && firingIndex < firingLength; firingIndex++ ) {\n\t\t\t\tif ( list[ firingIndex ].apply( data[ 0 ], data[ 1 ] ) === false && options.stopOnFalse ) {\n\t\t\t\t\tmemory = false; // To prevent further calls using add\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfiring = false;\n\t\t\tif ( list ) {\n\t\t\t\tif ( stack ) {\n\t\t\t\t\tif ( stack.length ) {\n\t\t\t\t\t\tfire( stack.shift() );\n\t\t\t\t\t}\n\t\t\t\t} else if ( memory ) {\n\t\t\t\t\tlist = [];\n\t\t\t\t} else {\n\t\t\t\t\tself.disable();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t// Actual Callbacks object\n\t\tself = {\n\t\t\t// Add a callback or a collection of callbacks to the list\n\t\t\tadd: function() {\n\t\t\t\tif ( list ) {\n\t\t\t\t\t// First, we save the current length\n\t\t\t\t\tvar start = list.length;\n\t\t\t\t\t(function add( args ) {\n\t\t\t\t\t\tjQuery.each( args, function( _, arg ) {\n\t\t\t\t\t\t\tvar type = jQuery.type( arg );\n\t\t\t\t\t\t\tif ( type === \"function\" ) {\n\t\t\t\t\t\t\t\tif ( !options.unique || !self.has( arg ) ) {\n\t\t\t\t\t\t\t\t\tlist.push( arg );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if ( arg && arg.length && type !== \"string\" ) {\n\t\t\t\t\t\t\t\t// Inspect recursively\n\t\t\t\t\t\t\t\tadd( arg );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t})( arguments );\n\t\t\t\t\t// Do we need to add the callbacks to the\n\t\t\t\t\t// current firing batch?\n\t\t\t\t\tif ( firing ) {\n\t\t\t\t\t\tfiringLength = list.length;\n\t\t\t\t\t// With memory, if we're not firing then\n\t\t\t\t\t// we should call right away\n\t\t\t\t\t} else if ( memory ) {\n\t\t\t\t\t\tfiringStart = start;\n\t\t\t\t\t\tfire( memory );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t// Remove a callback from the list\n\t\t\tremove: function() {\n\t\t\t\tif ( list ) {\n\t\t\t\t\tjQuery.each( arguments, function( _, arg ) {\n\t\t\t\t\t\tvar index;\n\t\t\t\t\t\twhile( ( index = jQuery.inArray( arg, list, index ) ) > -1 ) {\n\t\t\t\t\t\t\tlist.splice( index, 1 );\n\t\t\t\t\t\t\t// Handle firing indexes\n\t\t\t\t\t\t\tif ( firing ) {\n\t\t\t\t\t\t\t\tif ( index <= firingLength ) {\n\t\t\t\t\t\t\t\t\tfiringLength--;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif ( index <= firingIndex ) {\n\t\t\t\t\t\t\t\t\tfiringIndex--;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t// Control if a given callback is in the list\n\t\t\thas: function( fn ) {\n\t\t\t\treturn jQuery.inArray( fn, list ) > -1;\n\t\t\t},\n\t\t\t// Remove all callbacks from the list\n\t\t\tempty: function() {\n\t\t\t\tlist = [];\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t// Have the list do nothing anymore\n\t\t\tdisable: function() {\n\t\t\t\tlist = stack = memory = undefined;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t// Is it disabled?\n\t\t\tdisabled: function() {\n\t\t\t\treturn !list;\n\t\t\t},\n\t\t\t// Lock the list in its current state\n\t\t\tlock: function() {\n\t\t\t\tstack = undefined;\n\t\t\t\tif ( !memory ) {\n\t\t\t\t\tself.disable();\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t// Is it locked?\n\t\t\tlocked: function() {\n\t\t\t\treturn !stack;\n\t\t\t},\n\t\t\t// Call all callbacks with the given context and arguments\n\t\t\tfireWith: function( context, args ) {\n\t\t\t\targs = args || [];\n\t\t\t\targs = [ context, args.slice ? args.slice() : args ];\n\t\t\t\tif ( list && ( !fired || stack ) ) {\n\t\t\t\t\tif ( firing ) {\n\t\t\t\t\t\tstack.push( args );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfire( args );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t// Call all the callbacks with the given arguments\n\t\t\tfire: function() {\n\t\t\t\tself.fireWith( this, arguments );\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t// To know if the callbacks have already been called at least once\n\t\t\tfired: function() {\n\t\t\t\treturn !!fired;\n\t\t\t}\n\t\t};\n\n\treturn self;\n};\n\n","\n/*!\n* jquery-deferred\n* Copyright(c) 2011 Hidden <zzdhidden@gmail.com>\n* MIT Licensed\n*/\n\n/**\n* Library version.\n*/\n\nvar jQuery = module.exports = require(\"./jquery-callbacks.js\"),\n\tcore_slice = Array.prototype.slice;\n\n/**\n* jQuery deferred\n*\n* Code from: https://github.com/jquery/jquery/blob/master/src/deferred.js\n* Doc: http://api.jquery.com/category/deferred-object/\n*\n*/\n\njQuery.extend({\n\n\tDeferred: function( func ) {\n\t\tvar tuples = [\n\t\t\t\t// action, add listener, listener list, final state\n\t\t\t\t[ \"resolve\", \"done\", jQuery.Callbacks(\"once memory\"), \"resolved\" ],\n\t\t\t\t[ \"reject\", \"fail\", jQuery.Callbacks(\"once memory\"), \"rejected\" ],\n\t\t\t\t[ \"notify\", \"progress\", jQuery.Callbacks(\"memory\") ]\n\t\t\t],\n\t\t\tstate = \"pending\",\n\t\t\tpromise = {\n\t\t\t\tstate: function() {\n\t\t\t\t\treturn state;\n\t\t\t\t},\n\t\t\t\talways: function() {\n\t\t\t\t\tdeferred.done( arguments ).fail( arguments );\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\t\t\t\tthen: function( /* fnDone, fnFail, fnProgress */ ) {\n\t\t\t\t\tvar fns = arguments;\n\t\t\t\t\treturn jQuery.Deferred(function( newDefer ) {\n\t\t\t\t\t\tjQuery.each( tuples, function( i, tuple ) {\n\t\t\t\t\t\t\tvar action = tuple[ 0 ],\n\t\t\t\t\t\t\t\tfn = fns[ i ];\n\t\t\t\t\t\t\t// deferred[ done | fail | progress ] for forwarding actions to newDefer\n\t\t\t\t\t\t\tdeferred[ tuple[1] ]( jQuery.isFunction( fn ) ?\n\t\t\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\t\t\tvar returned = fn.apply( this, arguments );\n\t\t\t\t\t\t\t\t\tif ( returned && jQuery.isFunction( returned.promise ) ) {\n\t\t\t\t\t\t\t\t\t\treturned.promise()\n\t\t\t\t\t\t\t\t\t\t\t.done( newDefer.resolve )\n\t\t\t\t\t\t\t\t\t\t\t.fail( newDefer.reject )\n\t\t\t\t\t\t\t\t\t\t\t.progress( newDefer.notify );\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tnewDefer[ action + \"With\" ]( this === deferred ? newDefer : this, [ returned ] );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} :\n\t\t\t\t\t\t\t\tnewDefer[ action ]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tfns = null;\n\t\t\t\t\t}).promise();\n\t\t\t\t},\n\t\t\t\t// Get a promise for this deferred\n\t\t\t\t// If obj is provided, the promise aspect is added to the object\n\t\t\t\tpromise: function( obj ) {\n\t\t\t\t\treturn obj != null ? jQuery.extend( obj, promise ) : promise;\n\t\t\t\t}\n\t\t\t},\n\t\t\tdeferred = {};\n\n\t\t// Keep pipe for back-compat\n\t\tpromise.pipe = promise.then;\n\n\t\t// Add list-specific methods\n\t\tjQuery.each( tuples, function( i, tuple ) {\n\t\t\tvar list = tuple[ 2 ],\n\t\t\t\tstateString = tuple[ 3 ];\n\n\t\t\t// promise[ done | fail | progress ] = list.add\n\t\t\tpromise[ tuple[1] ] = list.add;\n\n\t\t\t// Handle state\n\t\t\tif ( stateString ) {\n\t\t\t\tlist.add(function() {\n\t\t\t\t\t// state = [ resolved | rejected ]\n\t\t\t\t\tstate = stateString;\n\n\t\t\t\t// [ reject_list | resolve_list ].disable; progress_list.lock\n\t\t\t\t}, tuples[ i ^ 1 ][ 2 ].disable, tuples[ 2 ][ 2 ].lock );\n\t\t\t}\n\n\t\t\t// deferred[ resolve | reject | notify ] = list.fire\n\t\t\tdeferred[ tuple[0] ] = list.fire;\n\t\t\tdeferred[ tuple[0] + \"With\" ] = list.fireWith;\n\t\t});\n\n\t\t// Make the deferred a promise\n\t\tpromise.promise( deferred );\n\n\t\t// Call given func if any\n\t\tif ( func ) {\n\t\t\tfunc.call( deferred, deferred );\n\t\t}\n\n\t\t// All done!\n\t\treturn deferred;\n\t},\n\n\t// Deferred helper\n\twhen: function( subordinate /* , ..., subordinateN */ ) {\n\t\tvar i = 0,\n\t\t\tresolveValues = core_slice.call( arguments ),\n\t\t\tlength = resolveValues.length,\n\n\t\t\t// the count of uncompleted subordinates\n\t\t\tremaining = length !== 1 || ( subordinate && jQuery.isFunction( subordinate.promise ) ) ? length : 0,\n\n\t\t\t// the master Deferred. If resolveValues consist of only a single Deferred, just use that.\n\t\t\tdeferred = remaining === 1 ? subordinate : jQuery.Deferred(),\n\n\t\t\t// Update function for both resolve and progress values\n\t\t\tupdateFunc = function( i, contexts, values ) {\n\t\t\t\treturn function( value ) {\n\t\t\t\t\tcontexts[ i ] = this;\n\t\t\t\t\tvalues[ i ] = arguments.length > 1 ? core_slice.call( arguments ) : value;\n\t\t\t\t\tif( values === progressValues ) {\n\t\t\t\t\t\tdeferred.notifyWith( contexts, values );\n\t\t\t\t\t} else if ( !( --remaining ) ) {\n\t\t\t\t\t\tdeferred.resolveWith( contexts, values );\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t},\n\n\t\t\tprogressValues, progressContexts, resolveContexts;\n\n\t\t// add listeners to Deferred subordinates; treat others as resolved\n\t\tif ( length > 1 ) {\n\t\t\tprogressValues = new Array( length );\n\t\t\tprogressContexts = new Array( length );\n\t\t\tresolveContexts = new Array( length );\n\t\t\tfor ( ; i < length; i++ ) {\n\t\t\t\tif ( resolveValues[ i ] && jQuery.isFunction( resolveValues[ i ].promise ) ) {\n\t\t\t\t\tresolveValues[ i ].promise()\n\t\t\t\t\t\t.done( updateFunc( i, resolveContexts, resolveValues ) )\n\t\t\t\t\t\t.fail( deferred.reject )\n\t\t\t\t\t\t.progress( updateFunc( i, progressContexts, progressValues ) );\n\t\t\t\t} else {\n\t\t\t\t\t--remaining;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// if we're not waiting on anything, resolve the master\n\t\tif ( !remaining ) {\n\t\t\tdeferred.resolveWith( resolveContexts, resolveValues );\n\t\t}\n\n\t\treturn deferred.promise();\n\t}\n});\n","\nmodule.exports = require('./lib/jquery-deferred');","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","/* \r\nCopyright 2017-2019 Dicky Suryadi\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n */\r\nimport { createEventEmitter } from '../libs/utils';\r\nimport jQueryShim from '../libs/jquery-shim';\r\nconst signalRNetCore = require('@aspnet/signalr');\r\nlet $ = jQueryShim;\r\n\r\nconst window = window || global || {};\r\n\r\nexport class dotnetifyHubFactory {\r\n  static create() {\r\n    let dotnetifyHub = {\r\n      version: '2.0.0',\r\n      type: null,\r\n\r\n      reconnectDelay: [ 2, 5, 10 ],\r\n      reconnectRetry: null,\r\n\r\n      _startInfo: null,\r\n      _init: false,\r\n\r\n      // Hub server methods.\r\n      requestVM: (iVMId, iOptions) => dotnetifyHub.server.request_VM(iVMId, iOptions),\r\n      updateVM: (iVMId, iValue) => dotnetifyHub.server.update_VM(iVMId, iValue),\r\n      disposeVM: iVMId => dotnetifyHub.server.dispose_VM(iVMId),\r\n\r\n      // Connection events.\r\n      responseEvent: createEventEmitter(),\r\n      reconnectedEvent: createEventEmitter(),\r\n      connectedEvent: createEventEmitter(),\r\n      connectionFailedEvent: createEventEmitter(),\r\n\r\n      get isHubStarted() {\r\n        return !!this._startInfo;\r\n      },\r\n\r\n      // Starts connection with SignalR hub server.\r\n      startHub(hubOptions, doneHandler, failHandler, forceRestart) {\r\n        const _doneHandler = () => {\r\n          if (typeof doneHandler == 'function') doneHandler();\r\n          this.connectedEvent.emit();\r\n        };\r\n        const _failHandler = ex => {\r\n          if (typeof failHander == 'function') failHandler();\r\n          this.connectionFailedEvent.emit();\r\n          throw ex;\r\n        };\r\n\r\n        if (this._startInfo === null || forceRestart) {\r\n          try {\r\n            this._startInfo = this.start(hubOptions).done(_doneHandler).fail(_failHandler);\r\n          } catch (err) {\r\n            this._startInfo = null;\r\n          }\r\n        }\r\n        else {\r\n          try {\r\n            this._startInfo.done(_doneHandler);\r\n          } catch (err) {\r\n            this._startInfo = null;\r\n            return this.startHub(hubOptions, doneHandler, failHandler, forceRestart);\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    // Configures connection to SignalR hub server.\r\n    dotnetifyHub.init = function(iHubPath, iServerUrl, signalR) {\r\n      if (dotnetifyHub._init) return;\r\n\r\n      dotnetifyHub._init = true;\r\n      signalR = signalR || window.signalR || signalRNetCore;\r\n\r\n      // SignalR .NET Core.\r\n      if (signalR && signalR.HubConnection) {\r\n        dotnetifyHub.type = 'netcore';\r\n\r\n        Object.defineProperty(dotnetifyHub, 'isConnected', {\r\n          get: function() {\r\n            return dotnetifyHub._connection && dotnetifyHub._connection.connection.connectionState === 1;\r\n          }\r\n        });\r\n\r\n        dotnetifyHub = $.extend(dotnetifyHub, {\r\n          hubPath: iHubPath || '/dotnetify',\r\n          url: iServerUrl,\r\n\r\n          // Internal variables. Do not modify!\r\n          _connection: null,\r\n          _reconnectCount: 0,\r\n          _startDoneHandler: null,\r\n          _startFailHandler: null,\r\n          _disconnectedHandler: function() {},\r\n          _stateChangedHandler: function(iNewState) {},\r\n\r\n          _onDisconnected: function() {\r\n            dotnetifyHub._changeState(4);\r\n            dotnetifyHub._disconnectedHandler();\r\n          },\r\n\r\n          _changeState: function(iNewState) {\r\n            if (iNewState == 1) dotnetifyHub._reconnectCount = 0;\r\n\r\n            let stateText = { 0: 'connecting', 1: 'connected', 2: 'reconnecting', 4: 'disconnected', 99: 'terminated' };\r\n            dotnetifyHub._stateChangedHandler(stateText[iNewState]);\r\n          },\r\n\r\n          _startConnection: function(iHubOptions, iTransportArray) {\r\n            let url = dotnetifyHub.url ? dotnetifyHub.url + dotnetifyHub.hubPath : dotnetifyHub.hubPath;\r\n            let hubOptions = {};\r\n            Object.keys(iHubOptions).forEach(function(key) {\r\n              hubOptions[key] = iHubOptions[key];\r\n            });\r\n            hubOptions.transport = iTransportArray.shift();\r\n\r\n            dotnetifyHub._connection = new signalR.HubConnectionBuilder().withUrl(url, hubOptions).build();\r\n            dotnetifyHub._connection.on('response_vm', dotnetifyHub.client.response_VM);\r\n            dotnetifyHub._connection.onclose(dotnetifyHub._onDisconnected);\r\n\r\n            let promise = dotnetifyHub._connection\r\n              .start()\r\n              .then(function() {\r\n                dotnetifyHub._changeState(1);\r\n              })\r\n              .catch(function() {\r\n                // If failed to start, fallback to the next transport.\r\n                if (iTransportArray.length > 0) dotnetifyHub._startConnection(iHubOptions, iTransportArray);\r\n                else dotnetifyHub._onDisconnected();\r\n              });\r\n\r\n            if (typeof dotnetifyHub._startDoneHandler === 'function')\r\n              promise.then(dotnetifyHub._startDoneHandler).catch(dotnetifyHub._startFailHandler || function() {});\r\n            return promise;\r\n          },\r\n\r\n          start: function(iHubOptions) {\r\n            dotnetifyHub._startDoneHandler = null;\r\n            dotnetifyHub._startFailHandler = null;\r\n\r\n            // Map the transport option.\r\n            let transport = [ 0 ];\r\n            let transportOptions = { webSockets: 0, serverSentEvents: 1, longPolling: 2 };\r\n            if (iHubOptions && Array.isArray(iHubOptions.transport))\r\n              transport = iHubOptions.transport.map(function(arg) {\r\n                return transportOptions[arg];\r\n              });\r\n\r\n            let promise = dotnetifyHub._startConnection(iHubOptions, transport);\r\n            return {\r\n              done: function(iHandler) {\r\n                dotnetifyHub._startDoneHandler = iHandler;\r\n                promise.then(iHandler).catch(function(error) {\r\n                  throw error;\r\n                });\r\n                return this;\r\n              },\r\n              fail: function(iHandler) {\r\n                dotnetifyHub._startFailHandler = iHandler;\r\n                promise.catch(iHandler);\r\n                return this;\r\n              }\r\n            };\r\n          },\r\n\r\n          disconnected: function(iHandler) {\r\n            if (typeof iHandler === 'function') dotnetifyHub._disconnectedHandler = iHandler;\r\n          },\r\n\r\n          stateChanged: function(iHandler) {\r\n            if (typeof iHandler === 'function') dotnetifyHub._stateChangedHandler = iHandler;\r\n          },\r\n\r\n          reconnect: function(iStartHubFunc) {\r\n            if (typeof iStartHubFunc === 'function') {\r\n              // Only attempt reconnect if the specified retry hasn't been exceeded.\r\n              if (!dotnetifyHub.reconnectRetry || dotnetifyHub._reconnectCount < dotnetifyHub.reconnectRetry) {\r\n                // Determine reconnect delay from the specified configuration array.\r\n                let delay =\r\n                  dotnetifyHub._reconnectCount < dotnetifyHub.reconnectDelay.length\r\n                    ? dotnetifyHub.reconnectDelay[dotnetifyHub._reconnectCount]\r\n                    : dotnetifyHub.reconnectDelay[dotnetifyHub.reconnectDelay.length - 1];\r\n\r\n                dotnetifyHub._reconnectCount++;\r\n\r\n                setTimeout(function() {\r\n                  dotnetifyHub._changeState(2);\r\n                  iStartHubFunc();\r\n                }, delay * 1000);\r\n              }\r\n              else dotnetifyHub._changeState(99);\r\n            }\r\n          },\r\n\r\n          client: {},\r\n\r\n          server: {\r\n            dispose_VM: function(iVMId) {\r\n              dotnetifyHub._connection.invoke('Dispose_VM', iVMId);\r\n            },\r\n            update_VM: function(iVMId, iValue) {\r\n              dotnetifyHub._connection.invoke('Update_VM', iVMId, iValue);\r\n            },\r\n            request_VM: function(iVMId, iArgs) {\r\n              dotnetifyHub._connection.invoke('Request_VM', iVMId, iArgs);\r\n            }\r\n          }\r\n        });\r\n      }\r\n      else {\r\n        // SignalR .NET FX.\r\n        dotnetifyHub.type = 'netfx';\r\n\r\n        if (window.jQuery) $ = window.jQuery;\r\n\r\n        // SignalR hub auto-generated from /signalr/hubs.\r\n        /// <reference path=\"..\\..\\SignalR.Client.JS\\Scripts\\jquery-1.6.4.js\" />\r\n        /// <reference path=\"jquery.signalR.js\" />\r\n        (function($, window, undefined) {\r\n          /// <param name=\"$\" type=\"jQuery\" />\r\n          'use strict';\r\n\r\n          if (typeof $.signalR !== 'function') {\r\n            throw new Error('SignalR: SignalR is not loaded. Please ensure jquery.signalR-x.js is referenced before ~/signalr/js.');\r\n          }\r\n\r\n          var signalR = $.signalR;\r\n\r\n          function makeProxyCallback(hub, callback) {\r\n            return function() {\r\n              // Call the client hub method\r\n              callback.apply(hub, $.makeArray(arguments));\r\n            };\r\n          }\r\n\r\n          function registerHubProxies(instance, shouldSubscribe) {\r\n            var key, hub, memberKey, memberValue, subscriptionMethod;\r\n\r\n            for (key in instance) {\r\n              if (instance.hasOwnProperty(key)) {\r\n                hub = instance[key];\r\n\r\n                if (!hub.hubName) {\r\n                  // Not a client hub\r\n                  continue;\r\n                }\r\n\r\n                if (shouldSubscribe) {\r\n                  // We want to subscribe to the hub events\r\n                  subscriptionMethod = hub.on;\r\n                }\r\n                else {\r\n                  // We want to unsubscribe from the hub events\r\n                  subscriptionMethod = hub.off;\r\n                }\r\n\r\n                // Loop through all members on the hub and find client hub functions to subscribe/unsubscribe\r\n                for (memberKey in hub.client) {\r\n                  if (hub.client.hasOwnProperty(memberKey)) {\r\n                    memberValue = hub.client[memberKey];\r\n\r\n                    if (!$.isFunction(memberValue)) {\r\n                      // Not a client hub function\r\n                      continue;\r\n                    }\r\n\r\n                    subscriptionMethod.call(hub, memberKey, makeProxyCallback(hub, memberValue));\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n\r\n          $.hubConnection.prototype.createHubProxies = function() {\r\n            var proxies = {};\r\n            this.starting(function() {\r\n              // Register the hub proxies as subscribed\r\n              // (instance, shouldSubscribe)\r\n              registerHubProxies(proxies, true);\r\n\r\n              this._registerSubscribedHubs();\r\n            }).disconnected(function() {\r\n              // Unsubscribe all hub proxies when we \"disconnect\".  This is to ensure that we do not re-add functional call backs.\r\n              // (instance, shouldSubscribe)\r\n              registerHubProxies(proxies, false);\r\n            });\r\n\r\n            proxies['dotNetifyHub'] = this.createHubProxy('dotNetifyHub');\r\n            proxies['dotNetifyHub'].client = {};\r\n            proxies['dotNetifyHub'].server = {\r\n              dispose_VM: function(vmId) {\r\n                return proxies['dotNetifyHub'].invoke.apply(proxies['dotNetifyHub'], $.merge([ 'Dispose_VM' ], $.makeArray(arguments)));\r\n              },\r\n\r\n              request_VM: function(vmId, vmArg) {\r\n                return proxies['dotNetifyHub'].invoke.apply(proxies['dotNetifyHub'], $.merge([ 'Request_VM' ], $.makeArray(arguments)));\r\n              },\r\n\r\n              update_VM: function(vmId, vmData) {\r\n                return proxies['dotNetifyHub'].invoke.apply(proxies['dotNetifyHub'], $.merge([ 'Update_VM' ], $.makeArray(arguments)));\r\n              }\r\n            };\r\n\r\n            return proxies;\r\n          };\r\n\r\n          signalR.hub = $.hubConnection(dotnetifyHub.hubPath, { useDefaultPath: false });\r\n          $.extend(signalR, signalR.hub.createHubProxies());\r\n        })($, window);\r\n\r\n        Object.defineProperty(dotnetifyHub, 'state', {\r\n          get: function() {\r\n            return $.connection.hub.state;\r\n          },\r\n          set: function(val) {\r\n            $.connection.hub.state = val;\r\n          }\r\n        });\r\n\r\n        Object.defineProperty(dotnetifyHub, 'client', {\r\n          get: function() {\r\n            return $.connection.dotNetifyHub.client;\r\n          }\r\n        });\r\n\r\n        Object.defineProperty(dotnetifyHub, 'server', {\r\n          get: function() {\r\n            return $.connection.dotNetifyHub.server;\r\n          }\r\n        });\r\n\r\n        Object.defineProperty(dotnetifyHub, 'isConnected', {\r\n          get: function() {\r\n            return $.connection.hub.state == $.signalR.connectionState.connected;\r\n          }\r\n        });\r\n\r\n        dotnetifyHub = $.extend(dotnetifyHub, {\r\n          hubPath: iHubPath || '/signalr',\r\n          url: iServerUrl,\r\n\r\n          _reconnectCount: 0,\r\n          _stateChangedHandler: function(iNewState) {},\r\n\r\n          start: function(iHubOptions) {\r\n            if (dotnetifyHub.url) $.connection.hub.url = dotnetifyHub.url;\r\n\r\n            let deferred;\r\n            if (iHubOptions) deferred = $.connection.hub.start(iHubOptions);\r\n            else deferred = $.connection.hub.start();\r\n            deferred.fail(function(error) {\r\n              if (error.source && error.source.message === 'Error parsing negotiate response.')\r\n                console.warn('This client may be attempting to connect to an incompatible SignalR .NET Core server.');\r\n            });\r\n            return deferred;\r\n          },\r\n\r\n          disconnected: function(iHandler) {\r\n            return $.connection.hub.disconnected(iHandler);\r\n          },\r\n\r\n          stateChanged: function(iHandler) {\r\n            dotnetifyHub._stateChangedHandler = iHandler;\r\n            return $.connection.hub.stateChanged(function(state) {\r\n              if (state == 1) dotnetifyHub._reconnectCount = 0;\r\n\r\n              let stateText = { 0: 'connecting', 1: 'connected', 2: 'reconnecting', 4: 'disconnected' };\r\n              iHandler(stateText[state.newState]);\r\n            });\r\n          },\r\n\r\n          reconnect: function(iStartHubFunc) {\r\n            if (typeof iStartHubFunc === 'function') {\r\n              // Only attempt reconnect if the specified retry hasn't been exceeded.\r\n              if (!dotnetifyHub.reconnectRetry || dotnetifyHub._reconnectCount < dotnetifyHub.reconnectRetry) {\r\n                // Determine reconnect delay from the specified configuration array.\r\n                let delay =\r\n                  dotnetifyHub._reconnectCount < dotnetifyHub.reconnectDelay.length\r\n                    ? dotnetifyHub.reconnectDelay[dotnetifyHub._reconnectCount]\r\n                    : dotnetifyHub.reconnectDelay[dotnetifyHub.reconnectDelay.length - 1];\r\n\r\n                dotnetifyHub._reconnectCount++;\r\n\r\n                setTimeout(function() {\r\n                  dotnetifyHub._stateChangedHandler('reconnecting');\r\n                  iStartHubFunc();\r\n                }, delay * 1000);\r\n              }\r\n              else dotnetifyHub._stateChangedHandler('terminated');\r\n            }\r\n          }\r\n        });\r\n      }\r\n\r\n      // Setup SignalR server method handler.\r\n      dotnetifyHub.client.response_VM = function(iVMId, iVMData) {\r\n        // SignalR .NET Core is sending an array of arguments.\r\n        if (Array.isArray(iVMId)) {\r\n          iVMData = iVMId[1];\r\n          iVMId = iVMId[0];\r\n        }\r\n\r\n        let handled = dotnetifyHub.responseEvent.emit(iVMId, iVMData);\r\n\r\n        // If we get to this point, that means the server holds a view model instance\r\n        // whose view no longer existed.  So, tell the server to dispose the view model.\r\n        if (!handled) dotnetifyHub.server.dispose_VM(iVMId);\r\n      };\r\n\r\n      // On disconnected, keep attempting to start the connection.\r\n      dotnetifyHub.disconnected(function() {\r\n        dotnetifyHub._startInfo = null;\r\n        dotnetifyHub.reconnect(function() {\r\n          dotnetifyHub.reconnectedEvent.emit();\r\n        });\r\n      });\r\n    };\r\n\r\n    return dotnetifyHub;\r\n  }\r\n}\r\n\r\nexport default dotnetifyHubFactory.create();\r\n","/* \r\nCopyright 2017-2019 Dicky Suryadi\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n */\r\nimport dotnetifyHub, { dotnetifyHubFactory } from './dotnetify-hub';\r\nimport localHub, { hasLocalVM } from './dotnetify-hub-local';\r\n\r\nexport class dotnetifyFactory {\r\n  static create() {\r\n    const dotnetify = {\r\n      // SignalR hub options.\r\n      hub: dotnetifyHub,\r\n      hubOptions: { transport: [ 'webSockets', 'longPolling' ] },\r\n      hubPath: null,\r\n\r\n      // Debug mode.\r\n      debug: false,\r\n      debugFn: null,\r\n\r\n      // Offline mode. (WIP)\r\n      offline: false,\r\n      isOffline: true,\r\n      offlineTimeout: 5000,\r\n      offlineCacheFn: null,\r\n\r\n      // Internal variables.\r\n      _vmAccessors: [],\r\n\r\n      // Use this to get notified of connection state changed events.\r\n      // (state, exception, hub) => void\r\n      connectionStateHandler: null,\r\n\r\n      // Use this intercept a view model prior to establishing connection,\r\n      // with the option to provide any connect parameters.\r\n      // ({vmId, options}) => {vmId, options, hub}\r\n      connectHandler: null,\r\n\r\n      // Support changing hub server URL after first init.\r\n      get hubServerUrl() {\r\n        return this.hub.url;\r\n      },\r\n\r\n      set hubServerUrl(url) {\r\n        this.hub.url = url;\r\n        if (this.debug) console.log('SignalR: connecting to ' + this.hubServerUrl);\r\n        if (this.hub.isHubStarted) this.startHub(this.hub, true);\r\n      },\r\n\r\n      // Generic connect function for non-React app.\r\n      connect(iVMId, iOptions) {\r\n        dotnetify.react.connect(iVMId, null, iOptions);\r\n      },\r\n\r\n      // Creates a SignalR hub client.\r\n      createHub(hubServerUrl, hubPath, hubLib) {\r\n        return this.initHub(dotnetifyHubFactory.create(), hubPath, hubServerUrl, hubLib);\r\n      },\r\n\r\n      // Configures hub connection to SignalR hub server.\r\n      initHub(hub, hubPath, hubServerUrl, hubLib) {\r\n        hub = hub || this.hub;\r\n        hubPath = hubPath || this.hubPath;\r\n        hubServerUrl = hubServerUrl || this.hubServerUrl;\r\n        hubLib = hubLib || this.hubLib;\r\n\r\n        if (!hub.isHubStarted) {\r\n          hub.init(hubPath, hubServerUrl, hubLib);\r\n\r\n          // Use SignalR event to raise the connection state event.\r\n          hub.stateChanged(state => this.handleConnectionStateChanged(state, null, hub));\r\n        }\r\n        return hub;\r\n      },\r\n\r\n      // Used by a view to select a hub, and provides the opportunity to override any connect info.\r\n      selectHub(vmConnectArgs) {\r\n        vmConnectArgs = vmConnectArgs || { options: {} };\r\n        let override = (typeof this.connectHandler == 'function' && this.connectHandler(vmConnectArgs)) || {};\r\n        if (!override.hub) {\r\n          override.hub = hasLocalVM(vmConnectArgs.vmId) ? localHub : this.initHub();\r\n          override.hub.debug = this.debug;\r\n        }\r\n        return Object.assign(vmConnectArgs, override);\r\n      },\r\n\r\n      // Starts hub connection to SignalR hub server.\r\n      startHub(hub, forceRestart) {\r\n        hub = hub || this.hub;\r\n\r\n        const doneHandler = () => {};\r\n        const failHandler = ex => this.handleConnectionStateChanged('error', ex, hub);\r\n        hub.startHub(this.hubOptions, doneHandler, failHandler, forceRestart);\r\n      },\r\n\r\n      // Used by dotnetify-react and -vue to expose their view model accessors.\r\n      addVMAccessor(vmAccessor) {\r\n        !this._vmAccessors.includes(vmAccessor) && this._vmAccessors.push(vmAccessor);\r\n      },\r\n\r\n      checkServerSideException(iVMId, iVMData, iExceptionHandler) {\r\n        const vmData = JSON.parse(iVMData);\r\n        if (vmData && vmData.hasOwnProperty('ExceptionType') && vmData.hasOwnProperty('Message')) {\r\n          const exception = { name: vmData.ExceptionType, message: vmData.Message };\r\n\r\n          if (typeof iExceptionHandler === 'function') {\r\n            return iExceptionHandler(exception);\r\n          }\r\n          else {\r\n            console.error('[' + iVMId + '] ' + exception.name + ': ' + exception.message);\r\n            throw exception;\r\n          }\r\n        }\r\n      },\r\n\r\n      // Get all view models.\r\n      getViewModels() {\r\n        return this._vmAccessors\r\n          .reduce((prev, current) => [ ...prev, ...current() ], [])\r\n          .filter((val, idx, self) => self.indexOf(val) === idx); // returns distinct items.\r\n      },\r\n\r\n      handleConnectionStateChanged(iState, iException, iHub) {\r\n        if (this.debug) console.log('SignalR: ' + (iException ? iException.message : iState));\r\n        if (typeof this.connectionStateHandler === 'function') this.connectionStateHandler(iState, iException, iHub);\r\n        else if (iException) console.error(iException);\r\n      }\r\n    };\r\n\r\n    return dotnetify;\r\n  }\r\n}\r\n\r\nexport default dotnetifyFactory.create();\r\n","/* \r\nCopyright 2017-2018 Dicky Suryadi\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n */\r\n\r\nimport React from 'react';\r\nimport dotnetify from './dotnetify-react';\r\n\r\nconst window = window || global || {};\r\n\r\n// <RouteTarget> is a helper component to provide DOM target for routes, and is essential for server-side rendering.\r\nexport default class RouteTarget extends React.Component {\r\n  componentWillMount() {\r\n    var elem = document.getElementById(this.props.id);\r\n    if (elem != null && window.ssr && !window.ssr[this.props.id]) {\r\n      window.ssr[this.props.id] = true;\r\n      this.initialHtml = { __html: elem.innerHTML };\r\n    }\r\n    else this.initialHtml = { __html: '' };\r\n  }\r\n\r\n  getDOMNode() {\r\n    return this.elem;\r\n  }\r\n\r\n  render() {\r\n    const { id, ...props } = this.props;\r\n    return <div id={id} ref={el => (this.elem = el)} {...this.props} dangerouslySetInnerHTML={this.initialHtml} />;\r\n  }\r\n}\r\n\r\ndotnetify.react.router.RouteTarget = RouteTarget;\r\n","/* \r\nCopyright 2017-2018 Dicky Suryadi\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n */\r\n\r\nimport React from 'react';\r\nimport dotnetify from './dotnetify-react';\r\n\r\n// <RouteLink> is a helper component to set anchor tags for routes.\r\nexport default class RouteLink extends React.Component {\r\n  render() {\r\n    const props = this.props;\r\n    if (props.vm == null) console.error(\"RouteLink requires 'vm' property.\");\r\n\r\n    const handleClick = event => {\r\n      event.preventDefault();\r\n      if (props.route == null) {\r\n        console.error(\"RouteLink requires 'route' property.\");\r\n        return;\r\n      }\r\n      if (typeof props.onClick === 'function' && props.onClick(event) === false) return;\r\n      return props.vm.$handleRoute(event);\r\n    };\r\n\r\n    return (\r\n      <a\r\n        style={props.style}\r\n        className={props.className}\r\n        href={props.route != null ? props.vm.$route(props.route) : ''}\r\n        children={props.children}\r\n        onClick={handleClick}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\ndotnetify.react.router.RouteLink = RouteLink;\r\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nmodule.exports = ReactPropTypesSecret;\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n\nfunction emptyFunction() {}\n\nmodule.exports = function() {\n  function shim(props, propName, componentName, location, propFullName, secret) {\n    if (secret === ReactPropTypesSecret) {\n      // It is still safe when called from React.\n      return;\n    }\n    var err = new Error(\n      'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n      'Use PropTypes.checkPropTypes() to call them. ' +\n      'Read more at http://fb.me/use-check-prop-types'\n    );\n    err.name = 'Invariant Violation';\n    throw err;\n  };\n  shim.isRequired = shim;\n  function getShim() {\n    return shim;\n  };\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n  var ReactPropTypes = {\n    array: shim,\n    bool: shim,\n    func: shim,\n    number: shim,\n    object: shim,\n    string: shim,\n    symbol: shim,\n\n    any: shim,\n    arrayOf: getShim,\n    element: shim,\n    instanceOf: getShim,\n    node: shim,\n    objectOf: getShim,\n    oneOf: getShim,\n    oneOfType: getShim,\n    shape: getShim,\n    exact: getShim\n  };\n\n  ReactPropTypes.checkPropTypes = emptyFunction;\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nif (process.env.NODE_ENV !== 'production') {\n  var REACT_ELEMENT_TYPE = (typeof Symbol === 'function' &&\n    Symbol.for &&\n    Symbol.for('react.element')) ||\n    0xeac7;\n\n  var isValidElement = function(object) {\n    return typeof object === 'object' &&\n      object !== null &&\n      object.$$typeof === REACT_ELEMENT_TYPE;\n  };\n\n  // By explicitly using `prop-types` you are opting into new development behavior.\n  // http://fb.me/prop-types-in-prod\n  var throwOnDirectAccess = true;\n  module.exports = require('./factoryWithTypeCheckers')(isValidElement, throwOnDirectAccess);\n} else {\n  // By explicitly using `prop-types` you are opting into new production behavior.\n  // http://fb.me/prop-types-in-prod\n  module.exports = require('./factoryWithThrowingShims')();\n}\n","/* \r\nCopyright 2017-2018 Dicky Suryadi\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n */\r\n\r\nimport React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport dotnetify from './dotnetify-react';\r\n\r\nconst window = window || global || {};\r\n\r\n// The <Scope> component uses React's 'context' to pass down the component hierarchy the name of the back-end view model\r\n// of the parent component, so that when the child component connects to its back-end view model, the child view model\r\n// instance is created within the scope of the parent view model.\r\n//\r\n// The <Scope> component also provides the 'connect' function for a component to connect to the back-end view model and\r\n// injects properties and dispatch functions into the component.\r\nexport default class Scope extends React.Component {\r\n  static displayName = 'Scope';\r\n  static version = '1.2.0';\r\n\r\n  static propTypes = { vm: PropTypes.string };\r\n  static contextTypes = { scoped: PropTypes.func };\r\n  static childContextTypes = {\r\n    scoped: PropTypes.func.isRequired,\r\n    connect: PropTypes.func.isRequired\r\n  };\r\n\r\n  scoped(vmId) {\r\n    var scope = this.context.scoped ? this.context.scoped(this.props.vm) : this.props.vm;\r\n    return scope ? scope + '.' + vmId : vmId;\r\n  }\r\n\r\n  getChildContext() {\r\n    const _this = this;\r\n\r\n    return {\r\n      scoped: vmId => _this.scoped(vmId),\r\n      connect: (vmId, component, options) => {\r\n        component.vmId = _this.scoped(vmId);\r\n        component.vm = dotnetify.react.connect(component.vmId, component, options);\r\n        component.dispatch = state => component.vm.$dispatch(state);\r\n\r\n        component.dispatchState = state => {\r\n          component.vm.State(state);\r\n          component.vm.$dispatch(state);\r\n        };\r\n        return window.vmStates ? window.vmStates[component.vmId] : null;\r\n      }\r\n    };\r\n  }\r\n  render() {\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\ndotnetify.react.Scope = Scope;\r\n","/* \r\nCopyright 2017-2018 Dicky Suryadi\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n */\r\nimport dotnetify from './dotnetify-react';\r\nimport dotnetifyVM from '../core/dotnetify-vm';\r\nimport $ from '../libs/jquery-shim';\r\n\r\nconst window = window || global || {};\r\n\r\n// Used by server-side rendering in lieu of connect method.\r\ndotnetify.react.ssrConnect = function(iVMId, iReact, iVMArg) {\r\n  if (window.ssr == null || !window.ssr.hasOwnProperty(iVMId))\r\n    console.error(\"Server-side rendering requires initial state in 'window.ssr.\" + iVMId + \"'.\");\r\n\r\n  var self = dotnetify.react;\r\n  var vmState = window.ssr[iVMId];\r\n  var getState = function() {\r\n    return vmState;\r\n  };\r\n  var setState = function(state) {\r\n    vmState = $.extend(vmState, state);\r\n  };\r\n  var options = {\r\n    getState: getState,\r\n    setState: setState,\r\n    vmArg: iVMArg\r\n  };\r\n  var vm = (self.viewModels[iVMId] = new dotnetifyVM(iVMId, iReact, options, self));\r\n\r\n  // Need to be asynch to allow initial state to be processed.\r\n  setTimeout(function() {\r\n    vm.$update(JSON.stringify(window.ssr[iVMId]));\r\n  }, 100);\r\n  return vm;\r\n};\r\n\r\n// Used by client-side React component to get server-side rendered initial state.\r\ndotnetify.react.router.ssrState = function(iVMId) {\r\n  if (window.ssr && window.ssr[iVMId] && !window.ssr[iVMId].fetched) {\r\n    window.ssr[iVMId].fetched = true;\r\n    return window.ssr[iVMId];\r\n  }\r\n};\r\n\r\n// Called from server to configure server-side rendering.\r\n// iPath - initial URL path.\r\n// iInitialStates - serialized object literal '{ \"vmName\": {initialState}, ...}'.\r\n// iOverrideRouteFn - function to override routing URLs before the router loads them.\r\n// iCallbackFn - callback after the path is fully routed.\r\n// iTimeout - timeout in milliseconds.\r\ndotnetify.react.router.ssr = function(iPath, iInitialStates, iOverrideRouteFn, iCallbackFn, iTimeout) {\r\n  dotnetify.ssr = true;\r\n  dotnetify.react.router.urlPath = iPath;\r\n  dotnetify.react.router.overrideUrl = iOverrideRouteFn;\r\n\r\n  // Insert initial states in the head tag.\r\n  var script = document.createElement('script');\r\n  script.type = 'text/javascript';\r\n  script.text = 'window.ssr=' + iInitialStates + ';';\r\n  var head = document.getElementsByTagName('head')[0];\r\n  if (head) head.insertBefore(script, head.firstChild);\r\n  else console.error('router> document head tag is required for server-side render.');\r\n\r\n  var routed = false;\r\n  var fallback = iTimeout\r\n    ? setTimeout(function() {\r\n        if (!routed) iCallbackFn();\r\n      }, iTimeout)\r\n    : 0;\r\n  window.addEventListener('dotnetify.routed', function() {\r\n    routed = true;\r\n    if (fallback != 0) clearTimeout(fallback);\r\n    iCallbackFn();\r\n  });\r\n\r\n  // Add initial states into the window scope for the server-renderd components.\r\n  window.ssr = JSON.parse(iInitialStates);\r\n};\r\n","/* \r\nCopyright 2017-2018 Dicky Suryadi\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n */\r\nimport utils from '../libs/utils';\r\n\r\nexport default class dotnetifyVMRouter {\r\n  routes = [];\r\n\r\n  get RoutingState() {\r\n    throw new Error('Not implemented');\r\n  }\r\n  get VMRoot() {\r\n    throw new Error('Not implemented');\r\n  }\r\n  get VMArg() {\r\n    throw new Error('Not implemented');\r\n  }\r\n\r\n  constructor(vm, router) {\r\n    this.vm = vm;\r\n    this.router = router;\r\n    this.debug = vm.$dotnetify.controller.debug;\r\n  }\r\n\r\n  // Dispatch the active routing state to the server.\r\n  dispatchActiveRoutingState(iPath) {\r\n    this.vm.$dispatch({ 'RoutingState.Active': iPath });\r\n    let { RoutingState } = this.vm.State();\r\n    RoutingState = Object.assign(RoutingState || {}, { Active: iPath });\r\n    this.vm.State({ RoutingState });\r\n  }\r\n\r\n  // Handles click event from anchor tags.  Argument can be event object or path string.\r\n  handleRoute(iArg) {\r\n    let path = null;\r\n    if (typeof iArg === 'object') {\r\n      iArg.preventDefault();\r\n      path = iArg.currentTarget.pathname;\r\n    }\r\n    else if (typeof iArg === 'string') path = iArg;\r\n\r\n    if (path == null || path == '') throw new Error('$handleRoute requires path argument or event with pathname.');\r\n    setTimeout(() => this.router.pushState({}, '', path));\r\n  }\r\n\r\n  // Build the absolute root path from the \"vmRoot\" property on React component.\r\n  initRoot() {\r\n    if (!this.hasRoutingState || this.RoutingState === null || this.RoutingState.Root === null) return;\r\n\r\n    if (this._absRoot != this.RoutingState.Root) {\r\n      var absRoot = utils.trim(this.VMRoot);\r\n      if (absRoot != '') absRoot = '/' + absRoot;\r\n      var root = utils.trim(this.RoutingState.Root);\r\n      this._absRoot = root != '' ? absRoot + '/' + root : absRoot;\r\n      this.RoutingState.Root = this._absRoot;\r\n    }\r\n  }\r\n\r\n  // Initialize routing templates if the view model implements IRoutable.\r\n  initRouting() {\r\n    const vm = this.vm;\r\n    if (!this.hasRoutingState) return;\r\n\r\n    if (this.RoutingState === null) {\r\n      console.error(\"router> the RoutingState prop of '\" + vm.$vmId + \"' was not initialized.\");\r\n      return;\r\n    }\r\n\r\n    var templates = this.RoutingState.Templates;\r\n    if (templates == null || templates.length == 0) return;\r\n\r\n    // Initialize the router.\r\n    if (!this.router.$init) {\r\n      this.router.init();\r\n      this.router.$init = true;\r\n    }\r\n\r\n    // Build the absolute root path.\r\n    this.initRoot();\r\n\r\n    templates.forEach(template => {\r\n      // If url pattern isn't given, consider Id as the pattern.\r\n      var urlPattern = template.UrlPattern != null ? template.UrlPattern : template.Id;\r\n      urlPattern = urlPattern != '' ? urlPattern : '/';\r\n      var mapUrl = this.toUrl(urlPattern);\r\n\r\n      if (this.debug) console.log('router> map ' + mapUrl + ' to template id=' + template.Id);\r\n\r\n      this.router.mapTo(mapUrl, iParams => {\r\n        this.router.urlPath = '';\r\n\r\n        // Construct the path from the template pattern and the params passed by PathJS.\r\n        var path = urlPattern;\r\n        for (var param in iParams) path = path.replace(':' + param, iParams[param]);\r\n        path = path.replace(/\\(\\/:([^)]+)\\)/g, '').replace(/\\(|\\)/g, '');\r\n\r\n        this.routeTo(path, template);\r\n      });\r\n    });\r\n\r\n    // Route initial URL.\r\n    var activeUrl = this.toUrl(this.RoutingState.Active);\r\n    if (this.router.urlPath == '') this.router.urlPath = activeUrl;\r\n    if (!this.routeUrl())\r\n      // If routing ends incomplete, raise routed event anyway.\r\n      this.raiseRoutedEvent(true);\r\n  }\r\n\r\n  // Whether a route is active.\r\n  isActive(iRoute) {\r\n    if (iRoute != null && iRoute.hasOwnProperty('Path')) {\r\n      return utils.equal(iRoute.Path, this.RoutingState.Active);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  // Loads an HTML view.\r\n  loadHtmlView(iTargetSelector, iViewUrl, iJsModuleUrl, iCallbackFn) {\r\n    const vm = this.vm;\r\n    this.unmountView(iTargetSelector);\r\n\r\n    // Load the HTML view.\r\n    $(iTargetSelector).load(iViewUrl, null, function() {\r\n      if (iJsModuleUrl != null) {\r\n        const getScripts = iJsModuleUrl.split(',').map(i => $.getScript(i));\r\n        $.when.apply($, getScripts).done(() => typeof callbackFn === 'function' && iCallbackFn.call(vm));\r\n      }\r\n      else if (typeof callbackFn === 'function') iCallbackFn.call(vm);\r\n    });\r\n  }\r\n\r\n  loadHtmlElementView(iTargetSelector, iHtmlElement, iJsModuleUrl, iVmArg, iCallbackFn) {\r\n    const vm = this.vm;\r\n    const mountViewFunc = () => {\r\n      this.unmountView(iTargetSelector);\r\n\r\n      const target = document.querySelector(iTargetSelector);\r\n      while (target.firstChild) target.removeChild(target.firstChild);\r\n      target.appendChild(iHtmlElement);\r\n\r\n      if (typeof callbackFn === 'function') iCallbackFn.call(vm);\r\n    };\r\n\r\n    if (iJsModuleUrl == null) mountViewFunc();\r\n    else {\r\n      // Load all javascripts first. Multiple files can be specified with comma delimiter.\r\n      const getScripts = iJsModuleUrl.split(',').map(i => $.getScript(i));\r\n      $.when.apply($, getScripts).done(mountViewFunc);\r\n    }\r\n  }\r\n\r\n  // Loads a view into a target element.\r\n  loadView(iTargetSelector, iViewUrl, iJsModuleUrl, iVmArg, iCallbackFn) {\r\n    throw new Error('Not implemented');\r\n  }\r\n\r\n  // Routes to a path.\r\n  manualRouteTo(iPath, iTarget, iViewUrl, iJSModuleUrl) {\r\n    const vm = this.vm;\r\n    var template = { Id: 'manual', Target: iTarget, ViewUrl: iViewUrl, JSModuleUrl: iJSModuleUrl };\r\n    this.routeTo(iPath, template, true);\r\n  }\r\n\r\n  // Handles route enter event.\r\n  onRouteEnter(iPath, iTemplate) {\r\n    return true;\r\n  }\r\n\r\n  // Raise event indicating the routing process has ended.\r\n  raiseRoutedEvent(force) {\r\n    const vm = this.vm;\r\n    if (this.router.urlPath == '' || force == true) {\r\n      if (this.debug) console.log('router> routed');\r\n      utils.dispatchEvent('dotnetify.routed');\r\n    }\r\n  }\r\n\r\n  // Returns the URL for an anchor tag.\r\n  route(iRoute, iTarget) {\r\n    // No route to process. Return silently.\r\n    if (iRoute == null) return;\r\n\r\n    if (!iRoute.hasOwnProperty('Path') && !iRoute.hasOwnProperty('TemplateId')) throw new Error('Not a valid route');\r\n\r\n    // Build the absolute root path.\r\n    this.initRoot();\r\n\r\n    // If the route path is not defined, use the URL pattern from the associated template.\r\n    // This is so that we don't send the same data twice if both are equal.\r\n    let path = iRoute.Path;\r\n    let template = null;\r\n    if (this.hasRoutingState && this.RoutingState.Templates != null && iRoute.TemplateId != null) {\r\n      let match = this.RoutingState.Templates.filter(function(iTemplate) {\r\n        return iTemplate.Id == iRoute.TemplateId;\r\n      });\r\n      if (match.length > 0) {\r\n        template = match[0];\r\n\r\n        if (typeof iTarget === 'string') template.Target = iTarget;\r\n\r\n        if (path == null) {\r\n          path = template.UrlPattern != null ? template.UrlPattern : template.Id;\r\n          iRoute.Path = path;\r\n        }\r\n      }\r\n      else if (iRoute.RedirectRoot == null) throw new Error(`vmRoute cannot find route template ${iRoute.TemplateId}`);\r\n    }\r\n\r\n    // If the path has a redirect root, the path doesn't belong to the current root and needs to be\r\n    // redirected to a different one.  Set the absolute path to the HREF attribute, and prevent the\r\n    // default behavior of the anchor click event and instead do push to HTML5 history state, which\r\n    // would attempt to resolve the path first before resorting to hard browser redirect.\r\n    if (iRoute.RedirectRoot != null) {\r\n      // Combine the redirect root with the view model's root.\r\n      let redirectRoot = iRoute.RedirectRoot;\r\n      if (redirectRoot.charAt(0) == '/') redirectRoot = redirectRoot.substr(0, redirectRoot.length - 1);\r\n      let redirectRootPath = iRoute.RedirectRoot.split('/');\r\n\r\n      let urlRedirect = '';\r\n      let absRoot = this.VMRoot;\r\n      if (absRoot != null) {\r\n        let absRootPath = absRoot.split('/');\r\n        for (let i = 0; i < absRootPath.length; i++) {\r\n          if (absRootPath[i] != '' && absRootPath[i] == redirectRootPath[0]) break;\r\n          urlRedirect += absRootPath[i] + '/';\r\n        }\r\n      }\r\n\r\n      urlRedirect += redirectRoot + '/' + path;\r\n      urlRedirect = urlRedirect.replace(/\\/\\/+/g, '/');\r\n      if (!this.routes.some(x => x.Path === path)) this.routes.push({ Path: path, Url: urlRedirect });\r\n      return urlRedirect;\r\n    }\r\n\r\n    // For quick lookup, save the mapping between the path to the route inside the view model.\r\n    if (template == null) throw new Error('vmRoute cannot find any route template');\r\n\r\n    iRoute.$template = template;\r\n    this.pathToRoute = this.pathToRoute || {};\r\n    this.pathToRoute[path] = iRoute;\r\n\r\n    // Set the absolute path to the HREF attribute, and prevent the default behavior of\r\n    // the anchor click event and instead do push to HTML5 history state.\r\n    let url = this.toUrl(path);\r\n    url = url.length > 0 ? url : '/';\r\n    if (!this.routes.some(x => x.Path === path)) this.routes.push({ Path: path, Url: url });\r\n    return url;\r\n  }\r\n\r\n  // Routes to a path.\r\n  routeTo(iPath, iTemplate, iDisableEvent, iCallbackFn, isRedirect) {\r\n    const vm = this.vm;\r\n    const viewModels = vm.$dotnetify.getViewModels();\r\n\r\n    if (this.debug) console.log(\"router> route '\" + iPath + \"' to template id=\" + iTemplate.Id);\r\n\r\n    // We can determine whether the view has already been loaded by matching the 'RoutingState.Origin' argument\r\n    // on the existing view model inside that target selector with the path.\r\n    for (let i = 0; i < viewModels.length; i++) {\r\n      var vmOther = viewModels[i];\r\n      var vmArg = vmOther.$router.VMArg;\r\n      if (vmArg != null) {\r\n        if (typeof vmArg['RoutingState.Origin'] === 'string' && utils.equal(vmArg['RoutingState.Origin'], iPath)) return;\r\n      }\r\n    }\r\n\r\n    // Support enter interception.\r\n    if (iDisableEvent != true && vm.hasOwnProperty('onRouteEnter')) {\r\n      if (this.onRouteEnter(iPath, iTemplate) == false || vm.onRouteEnter(iPath, iTemplate) == false) return;\r\n    }\r\n\r\n    // Check if the route has valid target.\r\n    if (iTemplate.Target == null) {\r\n      console.error(\"router> the Target for template '\" + iTemplate.Id + \"' was not set.  Use vm.onRouteEnter() to set the target.\");\r\n      return;\r\n    }\r\n\r\n    // If target DOM element isn't found, redirect URL to the path.\r\n    if (document.getElementById(iTemplate.Target) == null) {\r\n      if (isRedirect === true) {\r\n        if (this.debug) console.log(\"router> target '\" + iTemplate.Target + \"' not found in DOM\");\r\n        return;\r\n      }\r\n      else {\r\n        if (this.debug) console.log(\"router> target '\" + iTemplate.Target + \"' not found in DOM, use redirect instead\");\r\n        return this.router.redirect(this.toUrl(iPath), [ ...viewModels, ...vm.$dotnetify.controller.getViewModels() ]);\r\n      }\r\n    }\r\n\r\n    // Load the view associated with the route asynchronously.\r\n    this.loadView('#' + iTemplate.Target, iTemplate.ViewUrl, iTemplate.JSModuleUrl, { 'RoutingState.Origin': iPath }, () => {\r\n      // If load is successful, update the active route.\r\n      this.dispatchActiveRoutingState(iPath);\r\n\r\n      // Support exit interception.\r\n      if (iDisableEvent != true && vm.hasOwnProperty('onRouteExit')) vm.onRouteExit(iPath, iTemplate);\r\n\r\n      if (typeof iCallbackFn === 'function') iCallbackFn.call(vm);\r\n    });\r\n  }\r\n\r\n  routeToRoute(iRoute) {\r\n    var path = this.vm.$route(iRoute);\r\n    if (path == null || path == '') throw new Error('The route passed to $routeTo is invalid.');\r\n\r\n    setTimeout(() => this.router.pushState({}, '', path));\r\n  }\r\n\r\n  // Routes the URL if the view model implements IRoutable.\r\n  // Returns true if the view model handles the routing.\r\n  routeUrl(redirectUrlPath) {\r\n    if (!this.hasRoutingState) return false;\r\n\r\n    const isRedirect = !!redirectUrlPath;\r\n    let root = this.RoutingState.Root;\r\n    if (root == null) return false;\r\n\r\n    // Get the URL path to route.\r\n    let urlPath = isRedirect ? redirectUrlPath : this.router.urlPath;\r\n\r\n    if (this.debug) console.log('router> routing ' + urlPath);\r\n\r\n    // If the URL path matches the root path of this view, use the template with a blank URL pattern if provided.\r\n    if (utils.equal(urlPath, root) || utils.equal(urlPath, root + '/') || urlPath === '/') {\r\n      let match = utils.grep(this.RoutingState.Templates, function(iTemplate) {\r\n        return iTemplate.UrlPattern === '';\r\n      });\r\n      if (match.length > 0) {\r\n        this.routeTo('', match[0], null, null, isRedirect);\r\n        this.router.urlPath = '';\r\n        this.raiseRoutedEvent();\r\n        return true;\r\n      }\r\n      return false;\r\n    }\r\n\r\n    // If the URL path starts with the root path of this view, look at the next path and try to match it with the\r\n    // anchor tags in this view that are bound with the vmRoute binding type.  If there is match, route to that path.\r\n    root = root + '/';\r\n    if (utils.startsWith(urlPath, root)) {\r\n      let routeElem = null;\r\n      let match = utils.grep(this.routes, function(elem) {\r\n        return utils.startsWith(urlPath + '/', elem.Url + '/');\r\n      });\r\n      if (match.length > 0) {\r\n        // If more than one match, find the best match.\r\n        for (let i = 0; i < match.length; i++) if (routeElem == null || routeElem.Url.length < match[i].Url.length) routeElem = match[i];\r\n      }\r\n\r\n      if (routeElem != null) {\r\n        let path = routeElem.Path;\r\n        let template =\r\n          this.hasOwnProperty('pathToRoute') && this.pathToRoute.hasOwnProperty(path) ? this.pathToRoute[path].$template : null;\r\n        if (template != null) {\r\n          // If the URL path is completely routed, clear it.\r\n          if (utils.equal(this.router.urlPath, this.toUrl(path))) this.router.urlPath = '';\r\n\r\n          // If route's not already active, route to it.\r\n          if (!utils.equal(this.RoutingState.Active, path)) {\r\n            this.routeTo(path, template, false, () => this.raiseRoutedEvent(), isRedirect);\r\n          }\r\n          else this.raiseRoutedEvent();\r\n          return true;\r\n        }\r\n      }\r\n      else if (this.router.match(urlPath)) {\r\n        // If no vmRoute binding matches, try to match with any template's URL pattern.\r\n        this.router.urlPath = '';\r\n        this.raiseRoutedEvent();\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  // Builds an absolute URL from a path.\r\n  toUrl(iPath) {\r\n    let path = utils.trim(iPath);\r\n    if (path.charAt(0) != '(' && path != '') path = '/' + path;\r\n    return this.hasRoutingState ? this.RoutingState.Root + path : iPath;\r\n  }\r\n\r\n  // Unmount a view if there's one on the target selector.\r\n  unmountView(iTargetSelector) {\r\n    throw new Error('Not implemented');\r\n  }\r\n}\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE__23__;","/* \r\nCopyright 2017-2019 Dicky Suryadi\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n */\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport dotnetifyVMRouter from '../core/dotnetify-vm-router';\r\nimport $ from '../libs/jquery-shim';\r\nimport utils from '../libs/utils';\r\n\r\nconst window = window || global || {};\r\n\r\nexport default class dotnetifyReactVMRouter extends dotnetifyVMRouter {\r\n  get hasRoutingState() {\r\n    const state = this.vm.State();\r\n    return state && state.hasOwnProperty('RoutingState');\r\n  }\r\n  get RoutingState() {\r\n    return this.vm.State().RoutingState;\r\n  }\r\n  get VMRoot() {\r\n    return this.vm.Props('vmRoot');\r\n  }\r\n  get VMArg() {\r\n    return this.vm.Props('vmArg');\r\n  }\r\n\r\n  constructor(iVM, iDotNetifyRouter) {\r\n    super(iVM, iDotNetifyRouter);\r\n  }\r\n\r\n  onRouteEnter(iPath, iTemplate) {\r\n    if (!iTemplate.ViewUrl) iTemplate.ViewUrl = iTemplate.Id;\r\n    return true;\r\n  }\r\n\r\n  // Loads a view into a target element.\r\n  loadView(iTargetSelector, iViewUrl, iJsModuleUrl, iVmArg, iCallbackFn) {\r\n    const vm = this.vm;\r\n    let reactProps;\r\n\r\n    // If the view model supports routing, add the root path to the view, to be used\r\n    // to build the absolute route path, and view model argument if provided.\r\n    if (this.hasRoutingState) {\r\n      if (this.RoutingState === null) {\r\n        console.error(\"router> the RoutingState prop of '\" + vm.$vmId + \"' was not initialized.\");\r\n        return;\r\n      }\r\n\r\n      let root = this.VMRoot;\r\n      root = root != null ? '/' + utils.trim(this.RoutingState.Root) + '/' + utils.trim(root) : this.RoutingState.Root;\r\n      reactProps = { vmRoot: root, vmArg: iVmArg };\r\n    }\r\n\r\n    // Provide the opportunity to override the URL.\r\n    iViewUrl = this.router.overrideUrl(iViewUrl, iTargetSelector);\r\n    iJsModuleUrl = this.router.overrideUrl(iJsModuleUrl, iTargetSelector);\r\n\r\n    if (utils.endsWith(iViewUrl, 'html')) this.loadHtmlView(iTargetSelector, iViewUrl, iJsModuleUrl, iCallbackFn);\r\n    else {\r\n      let component = iViewUrl;\r\n      if (typeof iViewUrl === 'string' && window.hasOwnProperty(iViewUrl)) component = window[iViewUrl];\r\n\r\n      if (component instanceof HTMLElement) this.loadHtmlElementView(iTargetSelector, component, iJsModuleUrl, reactProps, iCallbackFn);\r\n      else this.loadReactView(iTargetSelector, component, iJsModuleUrl, reactProps, iCallbackFn);\r\n    }\r\n  }\r\n\r\n  // Loads a React view.\r\n  loadReactView(iTargetSelector, iComponent, iJsModuleUrl, iReactProps, iCallbackFn) {\r\n    return new Promise((resolve, reject) => {\r\n      const vm = this.vm;\r\n      const vmId = this.vm ? this.vm.$vmId : '';\r\n\r\n      const mountViewFunc = () => {\r\n        if (typeof iComponent !== 'function' && (typeof iComponent !== 'object' || iComponent.name == null)) {\r\n          console.error(`[${vmId}] failed to load view '${iComponent}' because it's not a valid React element.`);\r\n          reject();\r\n          return;\r\n        }\r\n\r\n        this.unmountView(iTargetSelector);\r\n\r\n        try {\r\n          var reactElement = React.createElement(iComponent, iReactProps);\r\n          ReactDOM.render(reactElement, document.querySelector(iTargetSelector));\r\n        } catch (e) {\r\n          console.error(e);\r\n        }\r\n        if (typeof callbackFn === 'function') iCallbackFn.call(vm, reactElement);\r\n        resolve(reactElement);\r\n      };\r\n\r\n      if (iJsModuleUrl == null || dotnetify.ssr === true) mountViewFunc();\r\n      else {\r\n        // Load all javascripts first. Multiple files can be specified with comma delimiter.\r\n        var getScripts = iJsModuleUrl.split(',').map(i => $.getScript(i));\r\n        $.when.apply($, getScripts).done(mountViewFunc);\r\n      }\r\n    });\r\n  }\r\n\r\n  // Unmount a React view if there's one on the target selector.\r\n  unmountView(iTargetSelector) {\r\n    try {\r\n      ReactDOM.unmountComponentAtNode(document.querySelector(iTargetSelector));\r\n    } catch (e) {\r\n      console.warn(e);\r\n    }\r\n  }\r\n}\r\n","/*\r\nPathJS - Copyright (c) 2011 Mike Trpcic, released under the MIT license.\r\n */\r\nconst window = window || global || {};\r\n\r\nvar Path = {\r\n  // Need this specific version, because latest version is causing issue.\r\n  version: '0.8.5',\r\n  map: function(path) {\r\n    if (Path.routes.defined.hasOwnProperty(path)) {\r\n      return Path.routes.defined[path];\r\n    }\r\n    else {\r\n      return new Path.core.route(path);\r\n    }\r\n  },\r\n  root: function(path) {\r\n    Path.routes.root = path;\r\n  },\r\n  rescue: function(fn) {\r\n    Path.routes.rescue = fn;\r\n  },\r\n  history: {\r\n    initial: {}, // Empty container for \"Initial Popstate\" checking variables.\r\n    pushState: function(state, title, path) {\r\n      if (Path.history.supported) {\r\n        if (Path.dispatch(path)) {\r\n          history.pushState(state, title, path);\r\n        }\r\n      }\r\n      else {\r\n        if (Path.history.fallback) {\r\n          window.location.hash = '#' + path;\r\n        }\r\n      }\r\n    },\r\n    popState: function(event) {\r\n      var initialPop = !Path.history.initial.popped && location.href == Path.history.initial.URL;\r\n      Path.history.initial.popped = true;\r\n      if (initialPop) return;\r\n      Path.dispatch(document.location.pathname === '/' ? '' : document.location.pathname);\r\n    },\r\n    listen: function(fallback) {\r\n      Path.history.supported = !!(window.history && window.history.pushState);\r\n      Path.history.fallback = fallback;\r\n\r\n      if (Path.history.supported) {\r\n        (Path.history.initial.popped = 'state' in window.history), (Path.history.initial.URL = location.href);\r\n        window.onpopstate = Path.history.popState;\r\n      }\r\n      else {\r\n        if (Path.history.fallback) {\r\n          for (route in Path.routes.defined) {\r\n            if (route.charAt(0) != '#') {\r\n              Path.routes.defined['#' + route] = Path.routes.defined[route];\r\n              Path.routes.defined['#' + route].path = '#' + route;\r\n            }\r\n          }\r\n          Path.listen();\r\n        }\r\n      }\r\n    }\r\n  },\r\n  match: function(path, parameterize) {\r\n    var params = {},\r\n      route = null,\r\n      possible_routes,\r\n      slice,\r\n      i,\r\n      j,\r\n      compare,\r\n      result;\r\n    for (route in Path.routes.defined) {\r\n      if (route !== null && route !== undefined) {\r\n        route = Path.routes.defined[route];\r\n        possible_routes = route.partition();\r\n        for (j = 0; j < possible_routes.length; j++) {\r\n          slice = possible_routes[j];\r\n          compare = path;\r\n          if (slice.search(/:/) > 0) {\r\n            for (i = 0; i < slice.split('/').length; i++) {\r\n              if (i < compare.split('/').length && slice.split('/')[i].charAt(0) === ':') {\r\n                params[slice.split('/')[i].replace(/:/, '')] = compare.split('/')[i];\r\n                result = compare.split('/');\r\n                result[i] = slice.split('/')[i];\r\n                compare = result.join('/');\r\n              }\r\n            }\r\n          }\r\n          if (slice === compare) {\r\n            if (parameterize) {\r\n              route.params = params;\r\n            }\r\n            return route;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return null;\r\n  },\r\n  dispatch: function(passed_route) {\r\n    var previous_route, matched_route;\r\n    if (Path.routes.current !== passed_route) {\r\n      Path.routes.previous = Path.routes.current;\r\n      Path.routes.current = passed_route;\r\n      matched_route = Path.match(passed_route, true);\r\n\r\n      if (Path.routes.previous) {\r\n        previous_route = Path.match(Path.routes.previous);\r\n        if (previous_route !== null && previous_route.do_exit !== null) {\r\n          previous_route.do_exit();\r\n        }\r\n      }\r\n\r\n      if (matched_route !== null) {\r\n        matched_route.run();\r\n        return true;\r\n      }\r\n      else {\r\n        if (Path.routes.rescue !== null) {\r\n          Path.routes.rescue();\r\n        }\r\n      }\r\n    }\r\n  },\r\n  listen: function() {\r\n    var fn = function() {\r\n      Path.dispatch(location.hash);\r\n    };\r\n\r\n    if (location.hash === '') {\r\n      if (Path.routes.root !== null) {\r\n        location.hash = Path.routes.root;\r\n      }\r\n    }\r\n\r\n    // The 'document.documentMode' checks below ensure that PathJS fires the right events\r\n    // even in IE \"Quirks Mode\".\r\n    if ('onhashchange' in window && (!document.documentMode || document.documentMode >= 8)) {\r\n      window.onhashchange = fn;\r\n    }\r\n    else {\r\n      setInterval(fn, 50);\r\n    }\r\n\r\n    if (location.hash !== '') {\r\n      Path.dispatch(location.hash);\r\n    }\r\n  },\r\n  core: {\r\n    route: function(path) {\r\n      this.path = path;\r\n      this.action = null;\r\n      this.do_enter = [];\r\n      this.do_exit = null;\r\n      this.params = {};\r\n      Path.routes.defined[path] = this;\r\n    }\r\n  },\r\n  routes: {\r\n    current: null,\r\n    root: null,\r\n    rescue: null,\r\n    previous: null,\r\n    defined: {}\r\n  }\r\n};\r\n\r\nPath.core.route.prototype = {\r\n  to: function(fn) {\r\n    this.action = fn;\r\n    return this;\r\n  },\r\n  enter: function(fns) {\r\n    if (fns instanceof Array) {\r\n      this.do_enter = this.do_enter.concat(fns);\r\n    }\r\n    else {\r\n      this.do_enter.push(fns);\r\n    }\r\n    return this;\r\n  },\r\n  exit: function(fn) {\r\n    this.do_exit = fn;\r\n    return this;\r\n  },\r\n  partition: function() {\r\n    var parts = [],\r\n      options = [],\r\n      re = /\\(([^}]+?)\\)/g,\r\n      text,\r\n      i;\r\n    while ((text = re.exec(this.path))) {\r\n      parts.push(text[1]);\r\n    }\r\n    options.push(this.path.split('(')[0]);\r\n    for (i = 0; i < parts.length; i++) {\r\n      options.push(options[options.length - 1] + parts[i]);\r\n    }\r\n    return options;\r\n  },\r\n  run: function() {\r\n    var halt_execution = false,\r\n      i,\r\n      result,\r\n      previous;\r\n\r\n    if (Path.routes.defined[this.path].hasOwnProperty('do_enter')) {\r\n      if (Path.routes.defined[this.path].do_enter.length > 0) {\r\n        for (i = 0; i < Path.routes.defined[this.path].do_enter.length; i++) {\r\n          result = Path.routes.defined[this.path].do_enter[i].apply(this, null);\r\n          if (result === false) {\r\n            halt_execution = true;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (!halt_execution) {\r\n      Path.routes.defined[this.path].action();\r\n    }\r\n  }\r\n};\r\n\r\nexport default Path;\r\n","/* \r\nCopyright 2017-2018 Dicky Suryadi\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n */\r\nimport Path from '../libs/path';\r\n\r\nconst window = window || global || {};\r\n\r\nexport default class dotnetifyRouter {\r\n  version = '2.0.1';\r\n\r\n  // URL path that will be parsed when performing routing.\r\n  urlPath = document.location.pathname;\r\n\r\n  constructor(debug) {\r\n    this.debug = debug;\r\n  }\r\n\r\n  // Initialize routing using PathJS.\r\n  init() {\r\n    if (typeof Path !== 'undefined') {\r\n      Path.history.listen(true);\r\n      Path.routes.rescue = function() {\r\n        //window.location.replace(document.location.pathname);\r\n      };\r\n    }\r\n    else throw new Error('Pathjs library is required for routing.');\r\n  }\r\n\r\n  // Map a route to an action.\r\n  mapTo(iPath, iFn) {\r\n    iPath = iPath.length > 0 ? iPath : '/';\r\n    if (typeof Path !== 'undefined')\r\n      Path.map(iPath).to(function() {\r\n        iFn(this.params);\r\n      });\r\n  }\r\n\r\n  // Match a URL path to a route and run the action.\r\n  match(iUrlPath) {\r\n    if (typeof Path !== 'undefined') {\r\n      var matched = Path.match(iUrlPath, true);\r\n      if (matched != null) {\r\n        matched.run();\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  // Optional callback to override a URL before performing routing.\r\n  overrideUrl(iUrl) {\r\n    return iUrl;\r\n  }\r\n\r\n  // Push state to HTML history.\r\n  pushState(iState, iTitle, iPath) {\r\n    this.urlPath = '';\r\n    if (typeof Path !== 'undefined') Path.history.pushState(iState, iTitle, iPath);\r\n  }\r\n\r\n  // Redirect to the a URL.\r\n  redirect(iUrl, viewModels) {\r\n    // Check first whether existing views can handle routing this URL.\r\n    // Otherwise, do a hard browser redirect.\r\n    this.urlPath = iUrl;\r\n    for (let i = 0; i < viewModels.length; i++) {\r\n      const vm = viewModels[i];\r\n      if (vm.$router.routeUrl(iUrl)) {\r\n        if (this.debug) console.log('router> redirected');\r\n        return;\r\n      }\r\n    }\r\n    window.location.replace(iUrl);\r\n  }\r\n\r\n  // Called by dotNetify when a view model is ready.\r\n  $ready() {\r\n    this.$router.initRouting();\r\n  }\r\n\r\n  // Called by dotNetify when a view model receives update.\r\n  $update(vmData) {\r\n    if (vmData && vmData.RoutingState) this.$router.initRouting();\r\n  }\r\n}\r\n","/* \r\nCopyright 2017 Dicky Suryadi\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n */\r\nimport dotnetify from './dotnetify-react';\r\nimport dotnetifyRouter from '../core/dotnetify-router';\r\nimport dotnetifyReactVMRouter from './dotnetify-react.vm-router';\r\n\r\n// Add plugin functions.\r\ndotnetify.react.router = new dotnetifyRouter(dotnetify.debug);\r\n\r\n// Inject a view model with functions.\r\ndotnetify.react.router.$inject = function(iVM) {\r\n  const router = new dotnetifyReactVMRouter(iVM, dotnetify.react.router);\r\n\r\n  // Put functions inside $router namespace.\r\n  iVM.$router = router;\r\n\r\n  // Handles click event from anchor tags.  Argument can be event object or path string.\r\n  iVM.$handleRoute = iArg => router.handleRoute(iArg);\r\n\r\n  // Returns the URL for an anchor tag.\r\n  iVM.$route = (iRoute, iTarget) => router.route(iRoute, iTarget);\r\n\r\n  // Executes the given route.\r\n  iVM.$routeTo = iRoute => router.routeToRoute(iRoute);\r\n};\r\n\r\n// Provide function to load a view.\r\ndotnetify.react.router.$mount = function(iTargetSelector, iComponent, iProps, iCallbackFn) {\r\n  return dotnetifyReactVMRouter.prototype.loadReactView(iTargetSelector, iComponent, null, iProps, iCallbackFn);\r\n};\r\n\r\n// Register the plugin to dotNetify.\r\ndotnetify.react.plugins['router'] = dotnetify.react.router;\r\n","import dotnetify from './dotnetify-react';\r\nimport './dotnetify-react.router';\r\nimport './ssr';\r\nimport Scope from './Scope';\r\nimport RouteLink from './RouteLink';\r\nimport RouteTarget from './RouteTarget';\r\n\r\nmodule.exports = Object.assign(dotnetify, { Scope, RouteLink, RouteTarget });\r\n"],"sourceRoot":""}