@page "/counter"

<h1>Counter</h1>

<VMContext ref="@vm" VM="Counter" OnStateChanged="@HandleStateChanged">
    <p>Current count: @state?.CurrentCount</p>

    <button class="btn btn-primary" onclick="@IncrementCount">Click me</button>
</VMContext>

@functions {
    CounterState state;
    VMContext vm;

    void HandleStateChanged(object newState)
    {
        state = newState.As<CounterState>();
        StateHasChanged();
    }

    void IncrementCount()
    {
        vm.DispatchAsync(nameof(IncrementCount));
    }
}